<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultados Dupla Sena</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#ba184a',
                        'primary-light': '#d41e5b',
                        'primary-dark': '#9e1440',
                        'light-bg': '#fef2f5',
                        'dark-bg': '#2e0a15',
                        'custom-100': '#ffffff',
                        'custom-95': '#fef2f5',
                        'custom-90': '#fde6eb',
                        'custom-85': '#fcd9e1',
                        'custom-80': '#fbccd7',
                        'custom-75': '#fabfcd',
                        'custom-70': '#f9b2c3',
                        'custom-65': '#f8a5b9',
                        'custom-60': '#f798af',
                        'custom-55': '#f68ba5',
                        'custom-50': '#f57e9b',
                        'custom-45': '#f47191',
                        'custom-40': '#f36487',
                        'custom-35': '#f2577d',
                        'custom-30': '#f14a73',
                        'custom-29': '#ba184a',
                        'custom-25': '#9e1440',
                        'custom-20': '#821136',
                        'custom-15': '#660d2b',
                        'custom-10': '#2e0a15',
                        'custom-5': '#1a0509',
                        'custom-0': '#000000'
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
            100% {
                transform: scale(1);
            }
        }
        .loading-circle {
            width: 100px;
            height: 100px;
            background-image: linear-gradient(#fef2f5, #ba184a, #660d2b);
            border-radius: 50%;
            animation: pulse 3s infinite;
        }
        
        .numero-par {
            background-color: #fcd9e1;
            color: #660d2b;
            border-radius: 8px;
            font-weight: 700;
            padding: 8px;
            font-size: 16px;
            text-align: center;
            min-width: 36px;
            min-height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid #9e1440;
        }
        
        .numero-impar {
            background-color: #f798af;
            color: #2e0a15;
            border-radius: 8px;
            font-weight: 700;
            padding: 8px;
            font-size: 16px;
            text-align: center;
            min-width: 36px;
            min-height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid #ba184a;
        }
        
        .dark .numero-par {
            background-color: #660d2b;
            color: #fcd9e1;
        }
        
        .dark .numero-impar {
            background-color: #9e1440;
            color: #fef2f5;
        }
        
        /* üéØ ESTILO OFICIAL CAIXA - MESMA COR PARA AMBOS SORTEIOS */
        .sorteio-1 .numero-par,
        .sorteio-2 .numero-par {
            background: #ba184a;
            color: white;
            border-radius: 50%;
            border: 3px solid #9e1440;
            box-shadow: 0 4px 12px rgba(186, 24, 74, 0.3);
            width: 40px;
            height: 40px;
            font-weight: 900;
        }
        
        .sorteio-1 .numero-impar,
        .sorteio-2 .numero-impar {
            background: #ba184a;
            color: white;
            border-radius: 50%;
            border: 3px solid #9e1440;
            box-shadow: 0 4px 12px rgba(186, 24, 74, 0.3);
            width: 40px;
            height: 40px;
            font-weight: 900;
        }
        
        /* Modo escuro - manter a mesma cor oficial */
        .dark .sorteio-1 .numero-par,
        .dark .sorteio-2 .numero-par,
        .dark .sorteio-1 .numero-impar,
        .dark .sorteio-2 .numero-impar {
            background: #ba184a;
            color: white;
            border-color: #d41e5b;
        }
        
        .filtro-ativo {
            background-color: #ba184a;
            color: white;
        }

        .numero-eliminado {
            background-color: #fca5a5;
            color: #7f1d1d;
            border: 2px solid #ef4444;
        }

        .dark .numero-eliminado {
            background-color: #7f1d1d;
            color: #fca5a5;
            border: 2px solid #dc2626;
        }

        .numero-disponivel {
            background-color: #f798af;
            color: #2e0a15;
            border: 2px solid #ba184a;
        }

        .dark .numero-disponivel {
            background-color: #660d2b;
            color: #f798af;
            border: 2px solid #9e1440;
        }

        .numero-palpite {
            background-color: #60a5fa;
            color: #1e3a8a;
            border: 2px solid #3b82f6;
            font-weight: bold;
        }

        .dark .numero-palpite {
            background-color: #1e3a8a;
            color: #60a5fa;
            border: 2px solid #2563eb;
        }
        
        .sorteio-badge-1 {
            background: linear-gradient(45deg, #ba184a, #d41e5b);
            color: white;
            font-weight: bold;
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 14px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        
        .sorteio-badge-2 {
            background: linear-gradient(45deg, #7c3aed, #a855f7);
            color: white;
            font-weight: bold;
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 14px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        
        .primeiro-sorteio {
            border-left: 4px solid #ba184a;
            background: linear-gradient(135deg, #fef2f5, #fde6eb);
        }
        
        .segundo-sorteio {
            border-left: 4px solid #7c3aed;
            background: linear-gradient(135deg, #f3f4f6, #e5e7eb);
        }
        
        /* Separador visual entre sorteios */
        .separador-sorteios {
            background: linear-gradient(to bottom, #ba184a, #7c3aed);
            width: 4px;
            min-height: 40px;
        }
    </style>
</head>
<body class="bg-light-bg dark:bg-dark-bg min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-800 dark:text-white mb-4">
                üéØ Resultados Dupla Sena - ORDEM DE SORTEIO
            </h1>
            <p class="text-gray-600 dark:text-gray-300">
                Resultados oficiais da Caixa Econ√¥mica Federal - DO PRIMEIRO AO √öLTIMO CONCURSO
            </p>
        </div>

        <!-- Controles -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8">
            <div class="flex flex-col gap-4">
                <div class="flex flex-col sm:flex-row gap-4 items-center justify-between">
                    <div class="flex flex-col sm:flex-row gap-4 items-center">
                        <label class="text-gray-700 dark:text-gray-300 font-medium">
                            Concursos:
                        </label>
                        <input 
                            type="number" 
                            id="concursoInicio" 
                            value="1"
                            placeholder="Concurso inicial"
                            class="px-4 py-2 text-base border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white"
                        >
                        <span class="text-gray-500 dark:text-gray-400">at√©</span>
                        <input 
                            type="number" 
                            id="concursoFim" 
                            placeholder="Buscando √∫ltimo..."
                            class="px-4 py-2 text-base border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white"
                        >
                    </div>
                    <button 
                        id="buscarBtn" 
                        class="bg-primary hover:bg-primary-dark text-white font-medium py-2 px-6 rounded-lg transition-colors duration-200 disabled:opacity-50"
                    >
                        üîç Carregar TODOS os Resultados
                    </button>
                </div>
                
                <!-- Op√ß√µes de destacar e ordena√ß√£o -->
                <div class="flex flex-col sm:flex-row gap-4 items-center">
                    <label class="text-gray-700 dark:text-gray-300 font-medium">
                        Destacar:
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" id="destacarPares" class="mr-2" checked>
                        <span class="text-gray-700 dark:text-gray-300">Pares</span>
                        <div class="w-4 h-4 ml-2 rounded border" style="background-color: #fcd9e1;"></div>
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" id="destacarImpares" class="mr-2" checked>
                        <span class="text-gray-700 dark:text-gray-300">√çmpares</span>
                        <div class="w-4 h-4 ml-2 rounded border" style="background-color: #f798af;"></div>
                    </label>
                    
                    <!-- Divisor -->
                    <div class="hidden sm:block w-px h-6 bg-gray-300 dark:bg-gray-600"></div>
                    
                    <label class="flex items-center">
                        <input type="checkbox" id="ordenarCrescente" class="mr-2">
                        <span class="text-gray-700 dark:text-gray-300">üìä Ordenar n√∫meros crescente</span>
                    </label>
                    
                    <!-- Divisor -->
                    <div class="hidden sm:block w-px h-6 bg-gray-300 dark:bg-gray-600"></div>
                    
                    <label class="flex items-center">
                        <input type="checkbox" id="ordenarConcursoDecrescente" class="mr-2" checked>
                        <span class="text-gray-700 dark:text-gray-300">üî¢ Concursos em ordem decrescente</span>
                    </label>
                </div>
            </div>
        </div>

        <!-- Loading -->
        <div id="loading" class="hidden text-center py-8">
            <div class="loading-circle mx-auto mb-4"></div>
            <p id="loadingText" class="text-gray-600 dark:text-gray-300 mb-4">
                Carregando TODOS os resultados do primeiro ao √∫ltimo concurso...
            </p>   
            
            <!-- Barra de progresso -->
            <div class="max-w-md mx-auto">
                <div class="bg-gray-200 dark:bg-gray-700 rounded-full h-3 mb-2">
                    <div id="progressBar" class="bg-primary h-3 rounded-full transition-all duration-300" style="width: 0%"></div>
                </div>
                <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400">
                    <span id="progressText">0 / 0 concursos</span>
                    <span id="progressPercent">0%</span>
                </div>
            </div>
            
            <!-- Bot√£o cancelar -->
            <button id="cancelarBtn" class="mt-4 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm transition-colors">
                ‚ùå Cancelar Carregamento
            </button>
        </div>

        <!-- Erro -->
        <div id="erro" class="hidden bg-red-100 dark:bg-red-900 border border-red-400 text-red-700 dark:text-red-200 px-4 py-3 rounded-lg mb-6">
            <span id="erroMsg"></span>
        </div>

        <!-- Bot√£o Toggle Tabela -->
        <div id="toggleTabelaContainer" class="hidden mb-4 text-center">
            <button 
                id="toggleTabelaBtn" 
                class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-6 rounded-lg transition-colors duration-200"
            >
                üëÅÔ∏è Ocultar Tabela de Resultados
            </button>
        </div>

        <!-- Tabela de Resultados -->
        <div id="resultados" class="hidden">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden">
                <div class="text-white p-4" style="background: linear-gradient(to right, #ba184a, #7c3aed);">
                    <h2 class="text-xl font-bold text-center">üéØ DUPLA SENA - TODOS OS CONCURSOS üé≤</h2>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50 dark:bg-gray-700">
                            <tr>
                                <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    Concurso
                                </th>
                                <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    Data Sorteio
                                </th>
                                <!-- 6 colunas para o 1¬∫ sorteio -->
                                <th colspan="6" class="px-2 py-3 text-center text-xs font-medium text-white uppercase tracking-wider" style="background: linear-gradient(45deg, #ba184a, #d41e5b);">
                                    <span class="sorteio-badge-1">
                                        üéØ 1¬∫ SORTEIO üéØ
                                    </span>
                                </th>
                                <!-- Separador visual -->
                                <th class="px-0 py-3 w-1" style="background: linear-gradient(to bottom, #ba184a, #7c3aed);">
                                </th>
                                <!-- 6 colunas para o 2¬∫ sorteio -->
                                <th colspan="6" class="px-2 py-3 text-center text-xs font-medium text-white uppercase tracking-wider" style="background: linear-gradient(45deg, #7c3aed, #a855f7);">
                                    <span class="sorteio-badge-2">
                                        üé≤ 2¬∫ SORTEIO üé≤
                                    </span>
                                </th>
                                <th class="px-3 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    P/I
                                </th>
                            </tr>
                            <tr>
                                <th></th>
                                <th></th>
                                <!-- Filtros para 1¬∫ sorteio -->
                                <th class="px-1 py-2 text-center" style="background-color: #fef2f5;">
                                    <input type="text" id="filtro1_1" placeholder="F" class="px-1 py-1 text-xs border rounded w-6">
                                </th>
                                <th class="px-1 py-2 text-center" style="background-color: #fef2f5;">
                                    <input type="text" id="filtro1_2" placeholder="F" class="px-1 py-1 text-xs border rounded w-6">
                                </th>
                                <th class="px-1 py-2 text-center" style="background-color: #fef2f5;">
                                    <input type="text" id="filtro1_3" placeholder="F" class="px-1 py-1 text-xs border rounded w-6">
                                </th>
                                <th class="px-1 py-2 text-center" style="background-color: #fef2f5;">
                                    <input type="text" id="filtro1_4" placeholder="F" class="px-1 py-1 text-xs border rounded w-6">
                                </th>
                                <th class="px-1 py-2 text-center" style="background-color: #fef2f5;">
                                    <input type="text" id="filtro1_5" placeholder="F" class="px-1 py-1 text-xs border rounded w-6">
                                </th>
                                <th class="px-1 py-2 text-center" style="background-color: #fef2f5;">
                                    <input type="text" id="filtro1_6" placeholder="F" class="px-1 py-1 text-xs border rounded w-6">
                                </th>
                                <!-- Separador -->
                                <th class="px-0 py-2 w-1 separador-sorteios"></th>
                                <!-- Filtros para 2¬∫ sorteio -->
                                <th class="px-1 py-2 text-center" style="background-color: #f3f4f6;">
                                    <input type="text" id="filtro2_1" placeholder="F" class="px-1 py-1 text-xs border rounded w-6">
                                </th>
                                <th class="px-1 py-2 text-center" style="background-color: #f3f4f6;">
                                    <input type="text" id="filtro2_2" placeholder="F" class="px-1 py-1 text-xs border rounded w-6">
                                </th>
                                <th class="px-1 py-2 text-center" style="background-color: #f3f4f6;">
                                    <input type="text" id="filtro2_3" placeholder="F" class="px-1 py-1 text-xs border rounded w-6">
                                </th>
                                <th class="px-1 py-2 text-center" style="background-color: #f3f4f6;">
                                    <input type="text" id="filtro2_4" placeholder="F" class="px-1 py-1 text-xs border rounded w-6">
                                </th>
                                <th class="px-1 py-2 text-center" style="background-color: #f3f4f6;">
                                    <input type="text" id="filtro2_5" placeholder="F" class="px-1 py-1 text-xs border rounded w-6">
                                </th>
                                <th class="px-1 py-2 text-center" style="background-color: #f3f4f6;">
                                    <input type="text" id="filtro2_6" placeholder="F" class="px-1 py-1 text-xs border rounded w-6">
                                </th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="tabelaBody" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                            <!-- Resultados ser√£o inseridos aqui -->
                        </tbody>
                    </table>
                </div>
                
                <div class="bg-gray-50 dark:bg-gray-700 px-4 py-3">
                    <div class="flex flex-col sm:flex-row justify-between items-center">
                        <p class="text-sm text-gray-600 dark:text-gray-300">
                            üìä Fonte: Caixa Econ√¥mica Federal - API Oficial
                        </p>
                        <p id="contadorResultados" class="text-sm font-medium text-primary-dark dark:text-primary-light">
                            <!-- Contador ser√° inserido aqui -->
                        </p>
                    </div>
                    
                    <!-- Legenda visual -->
                    <div class="mt-4 p-3 bg-blue-50 dark:bg-blue-900 rounded-lg">
                        <h4 class="text-sm font-bold text-blue-800 dark:text-blue-200 mb-2">üîç Dupla Sena - 6 n√∫meros por sorteio:</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-xs">
                            <div class="flex items-center gap-2">
                                <div class="w-6 h-6 rounded-full" style="background: #ba184a; border: 2px solid #9e1440;"></div>
                                <span class="text-blue-700 dark:text-blue-300">üéØ 1¬∫ e 2¬∫ Sorteio - Mesma cor oficial (vermelho/rosa)</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <span class="text-blue-700 dark:text-blue-300 text-xs">‚ú® Cada sorteio tem exatamente 6 dezenas √∫nicas</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Resumo Estat√≠stico -->
        <div id="resumoEstatistico" class="hidden mt-8 rounded-lg p-6" style="background: linear-gradient(to right, #fef2f5, #fde6eb); border: 1px solid #f798af;">
            <h3 class="text-xl font-bold mb-6 text-center" style="color: #660d2b;">
                üìä Resumo Estat√≠stico Par/√çmpar
            </h3>
            <div id="estatisticasGerais" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Estat√≠sticas ser√£o inseridas aqui -->
            </div>
            
            <!-- Gr√°fico visual simples -->
            <div class="mt-6 p-4 bg-white dark:bg-gray-800 rounded-lg">
                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3 text-center">
                    üéØ Distribui√ß√£o de Padr√µes
                </h4>
                <div id="graficoBarras" class="space-y-3">
                    <!-- Gr√°fico de barras ser√° inserido aqui -->
                </div>
            </div>
            
            <!-- Estat√≠sticas por sorteio -->
            <div id="estatisticasSorteios" class="mt-6 p-4 bg-white dark:bg-gray-800 rounded-lg">
                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3 text-center">
                    üéØ Compara√ß√£o entre Sorteios
                </h4>
                <div id="dadosSorteios" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Dados dos sorteios ser√£o inseridos aqui -->
                </div>
            </div>

            <!-- An√°lise Visual por Sorteio -->
            <div id="analiseVisual" class="hidden mt-6 p-4 rounded-lg" style="background: linear-gradient(to bottom right, #fde6eb, #fcd9e1); border: 1px solid #f798af;">
                <h4 class="text-lg font-semibold mb-3 text-center" style="color: #660d2b;">
                    üìä An√°lise Visual - N√∫meros que Sa√≠ram por Sorteio
                </h4>
                
                <!-- Controle de jogos a analisar -->
                <div class="flex flex-col sm:flex-row items-center justify-center gap-4 mb-4">
                    <label class="text-sm font-medium" style="color: #821136;">
                        Analisar √∫ltimos:
                    </label>
                    <input 
                        type="number" 
                        id="jogosAnalisar" 
                        value="50"
                        min="1"
                        max="100"
                        placeholder="N¬∫ de jogos"
                        class="px-3 py-2 text-base border rounded-lg focus:ring-2 dark:bg-gray-700 dark:text-white w-24"
                        style="border-color: #f798af; --tw-ring-color: #ba184a;"
                    >
                    <span class="text-sm" style="color: #821136;">jogos mais recentes</span>
                    <button 
                        id="atualizarAnalise" 
                        class="text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 text-sm"
                        style="background-color: #ba184a;"
                        onmouseover="this.style.backgroundColor='#9e1440'"
                        onmouseout="this.style.backgroundColor='#ba184a'"
                    >
                        üîÑ Atualizar
                    </button>
                </div>
                
                <p class="text-sm text-center mb-4" style="color: #821136;">
                    ‚úÖ = N√∫mero saiu neste sorteio | Em branco = N√∫mero N√ÉO saiu
                </p>
                
                <!-- Tabelas visuais para ambos os sorteios -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- 1¬∫ Sorteio -->
                    <div class="primeiro-sorteio p-4 rounded-lg">
                        <h5 class="text-center font-bold mb-3" style="color: #660d2b;">üéØ 1¬∫ Sorteio</h5>
                        <div class="overflow-x-auto">
                            <table id="tabelaAnalise1" class="w-full rounded-lg" style="border: 1px solid #f798af;">
                                <!-- Tabela ser√° gerada dinamicamente -->
                            </table>
                        </div>
                        <div id="resumoAnalise1" class="mt-2 text-center text-sm" style="color: #660d2b;">
                            <!-- Resumo ser√° inserido aqui -->
                        </div>
                    </div>
                    
                    <!-- 2¬∫ Sorteio -->
                    <div class="segundo-sorteio p-4 rounded-lg">
                        <h5 class="text-center font-bold mb-3" style="color: #660d2b;">üé≤ 2¬∫ Sorteio</h5>
                        <div class="overflow-x-auto">
                            <table id="tabelaAnalise2" class="w-full rounded-lg" style="border: 1px solid #7c3aed;">
                                <!-- Tabela ser√° gerada dinamicamente -->
                            </table>
                        </div>
                        <div id="resumoAnalise2" class="mt-2 text-center text-sm" style="color: #660d2b;">
                            <!-- Resumo ser√° inserido aqui -->
                        </div>
                    </div>
                </div>
                
                <!-- N√∫meros que N√ÉO sa√≠ram -->
                <div class="mt-6 p-4 bg-blue-100 dark:bg-blue-800 rounded-lg">
                    <p class="text-sm font-medium text-blue-800 dark:text-blue-200 mb-3 text-center">
                        N√öMEROS QUE N√ÉO SA√çRAM NOS √öLTIMOS <span id="jogosEscolhidos">50</span> JOGOS:
                    </p>
                    <div id="numerosNaoSairam" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- N√∫meros que n√£o sa√≠ram ser√£o inseridos aqui -->
                    </div>
                </div>
            </div>

            <!-- Padr√µes encontrados -->
            <div class="mt-6 p-4 bg-white dark:bg-gray-800 rounded-lg">
                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3 text-center">
                    üîç Padr√µes Identificados
                </h4>
                <div id="padroes" class="text-sm text-gray-700 dark:text-gray-300">
                    <!-- Padr√µes ser√£o inseridos aqui -->
                </div>
            </div>
        </div>

        <!-- Gerador de Palpites -->
        <div id="geradorPalpites" class="hidden mt-8 bg-gradient-to-r from-purple-50 to-indigo-50 dark:from-purple-900 dark:to-indigo-900 border border-purple-200 dark:border-purple-700 rounded-lg p-6">
            <div class="text-center mb-6">
                <h3 class="text-2xl font-bold text-purple-800 dark:text-purple-200 mb-2">
                    üéØ Gerador de Palpites Inteligente
                </h3>
                <p class="text-purple-600 dark:text-purple-300 text-sm">
                    Estrat√©gias baseadas em elimina√ß√£o de n√∫meros dos √∫ltimos concursos
                </p>
                <button 
                    id="comoFuncionaBtn" 
                    class="mt-2 px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white text-sm rounded-lg transition-colors"
                >
                    ‚ùì Como Funciona?
                </button>
            </div>

            <!-- Informa√ß√µes do √öltimo Concurso -->
            <div id="infoConcursoAtual" class="bg-white dark:bg-gray-800 rounded-lg p-4 mb-6">
                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3 text-center">
                    üìä √öltimo Concurso Dispon√≠vel
                </h4>
                <div id="dadosUltimoConcurso" class="text-center">
                    <!-- Dados do √∫ltimo concurso ser√£o inseridos aqui -->
                </div>
            </div>

            <!-- Estrat√©gias de Palpite -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                <!-- Estrat√©gia 1: Elimina√ß√£o Simples -->
                <div class="bg-green-50 dark:bg-green-900 border border-green-200 dark:border-green-700 rounded-lg p-4">
                    <h4 class="text-lg font-bold text-green-800 dark:text-green-200 mb-3 text-center">
                        üé≤ Estrat√©gia 1: Elimina√ß√£o Simples
                    </h4>
                    <p class="text-sm text-green-700 dark:text-green-300 mb-4 text-center">
                        Elimina apenas os 12 n√∫meros dos √∫ltimos concursos (6 de cada sorteio)
                    </p>
                    
                    <!-- Controles de quantidade -->
                    <div class="mb-4 text-center">
                        <label class="text-sm font-medium text-green-700 dark:text-green-300 block mb-2">
                            Quantidade de jogos:
                        </label>
                        <input 
                            type="number" 
                            id="quantidadeJogos1" 
                            value="1"
                            min="1"
                            max="3"
                            step="1"
                            class="px-3 py-1 text-base border border-green-300 dark:border-green-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent dark:bg-gray-700 dark:text-white w-20 text-center"
                        />
                        <span class="text-xs text-green-600 dark:text-green-400 block mt-1">
                            M√°x: 38 jogos por sorteio (n√∫meros √∫nicos)
                        </span>
                    </div>
                    
                    <div class="text-center">
                        <button 
                            id="gerarEstrategia1" 
                            class="bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded-lg transition-colors disabled:opacity-50"
                        >
                            üéØ Gerar Palpites
                        </button>
                    </div>
                    <div id="resultadoEstrategia1" class="mt-4 hidden">
                        <!-- Resultado da estrat√©gia 1 -->
                    </div>
                </div>

                <!-- Estrat√©gia 2: Elimina√ß√£o Progressiva -->
                <div class="bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700 rounded-lg p-4">
                    <h4 class="text-lg font-bold text-blue-800 dark:text-blue-200 mb-3 text-center">
                        üîÑ Estrat√©gia 2: Elimina√ß√£o Progressiva
                    </h4>
                    <p class="text-sm text-blue-700 dark:text-blue-300 mb-4 text-center">
                        Elimina n√∫meros usados a cada sequ√™ncia
                    </p>
                    <div class="text-center space-y-2">
                        <div id="statusProgressivo" class="text-xs text-blue-600 dark:text-blue-400">
                            Sequ√™ncia: 1/6 | Dispon√≠veis: 38
                        </div>
                        <button 
                            id="gerarEstrategia2" 
                            class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-lg transition-colors disabled:opacity-50"
                        >
                            üîÑ Pr√≥xima Sequ√™ncia
                        </button>
                        <button 
                            id="resetEstrategia2" 
                            class="bg-red-500 hover:bg-red-600 text-white text-sm py-1 px-3 rounded transition-colors"
                        >
                            üîÑ Reset
                        </button>
                    </div>
                    <div id="resultadoEstrategia2" class="mt-4 hidden">
                        <!-- Resultado da estrat√©gia 2 -->
                    </div>
                </div>

                <!-- Estrat√©gia 3: Elimina√ß√£o Livre -->
                <div class="bg-purple-50 dark:bg-purple-900 border border-purple-200 dark:border-purple-700 rounded-lg p-4">
                    <h4 class="text-lg font-bold text-purple-800 dark:text-purple-200 mb-3 text-center">
                        üé∞ Estrat√©gia 3: Elimina√ß√£o Livre
                    </h4>
                    <p class="text-sm text-purple-700 dark:text-purple-300 mb-4 text-center">
                        Elimina apenas os 12 n√∫meros dos √∫ltimos concursos (permite repetir n√∫meros entre jogos)
                    </p>
                    
                    <!-- Controles de quantidade -->
                    <div class="mb-4 text-center">
                        <label class="text-sm font-medium text-purple-700 dark:text-purple-300 block mb-2">
                            Quantidade de jogos:
                        </label>
                        <input 
                            type="number" 
                            id="quantidadeJogos3" 
                            value="5"
                            min="1"
                            max="50"
                            class="px-3 py-1 text-base border border-purple-300 dark:border-purple-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent dark:bg-gray-700 dark:text-white w-20 text-center"
                        >
                        <span class="text-xs text-purple-600 dark:text-purple-400 block mt-1">
                            M√°x: 50 jogos por sorteio (permite repeti√ß√£o)
                        </span>
                    </div>
                    
                    <div class="text-center">
                        <button 
                            id="gerarEstrategia3" 
                            class="bg-purple-500 hover:bg-purple-600 text-white font-medium py-2 px-4 rounded-lg transition-colors disabled:opacity-50"
                        >
                            üé∞ Gerar Palpites
                        </button>
                    </div>
                    <div id="resultadoEstrategia3" class="mt-4 hidden">
                        <!-- Resultado da estrat√©gia 3 -->
                    </div>
                </div>
            </div>

            <!-- Visualiza√ß√£o dos N√∫meros -->
            <div class="bg-white dark:bg-gray-800 rounded-lg p-4 mb-6">
                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4 text-center">
                    üîç Status dos N√∫meros
                </h4>
                
                <!-- N√∫meros Eliminados -->
                <div class="mb-4">
                    <h5 class="text-sm font-medium text-red-600 dark:text-red-400 mb-2">
                        ‚ùå N√∫meros Eliminados:
                    </h5>
                    <div id="numerosEliminados" class="flex flex-wrap gap-2">
                        <!-- N√∫meros eliminados ser√£o inseridos aqui -->
                    </div>
                </div>

                <!-- N√∫meros Dispon√≠veis -->
                <div>
                    <h5 class="text-sm font-medium text-green-600 dark:text-green-400 mb-2">
                        ‚úÖ N√∫meros Dispon√≠veis:
                    </h5>
                    <div id="numerosDisponiveis" class="flex flex-wrap gap-2">
                        <!-- N√∫meros dispon√≠veis ser√£o inseridos aqui -->
                    </div>
                </div>
            </div>

            <!-- Hist√≥rico de Palpites -->
            <div id="historicoPalpites" class="bg-gradient-to-br from-yellow-50 to-orange-50 dark:from-yellow-900 dark:to-orange-900 border border-yellow-200 dark:border-yellow-700 rounded-lg p-4">
                <h4 class="text-lg font-semibold text-yellow-800 dark:text-yellow-200 mb-4 text-center">
                    üìã Hist√≥rico de Palpites Gerados
                </h4>
                <div id="listaPalpites" class="space-y-2">
                    <p class="text-sm text-yellow-700 dark:text-yellow-300 text-center italic">
                        Nenhum palpite gerado ainda
                    </p>
                </div>
                <div class="text-center mt-4">
                    <button 
                        id="limparHistorico" 
                        class="bg-yellow-500 hover:bg-yellow-600 text-white text-sm py-2 px-4 rounded-lg transition-colors"
                    >
                        üóëÔ∏è Limpar Hist√≥rico
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal Popup "Como Funciona" -->
        <div id="modalComoFunciona" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-4xl w-full mx-4 max-h-screen overflow-y-auto">
                <div class="bg-gradient-to-r from-purple-500 to-indigo-500 text-white p-6 rounded-t-lg">
                    <h2 class="text-2xl font-bold text-center">
                        üéØ Como Funciona o Gerador de Palpites
                    </h2>
                </div>
                
                <div class="p-6 space-y-6">
                    <!-- Estrat√©gia 1 -->
                    <div class="bg-green-50 dark:bg-green-900 border border-green-200 dark:border-green-700 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-green-800 dark:text-green-200 mb-3">
                            üé≤ Estrat√©gia 1: Elimina√ß√£o Simples
                        </h3>
                        <div class="space-y-3 text-green-700 dark:text-green-300">
                            <p><strong>Conceito:</strong> Remove apenas os 12 n√∫meros que sa√≠ram no √∫ltimo concurso (6 do 1¬∫ + 6 do 2¬∫ sorteio).</p>
                            <p><strong>L√≥gica:</strong> A chance dos mesmos 12 n√∫meros sa√≠rem novamente √© muito baixa.</p>
                            <div class="bg-white dark:bg-gray-800 p-3 rounded border-l-4 border-green-500">
                                <p class="font-medium mb-2">Exemplo pr√°tico:</p>
                                <p>‚Ä¢ <span class="font-bold">1¬∫ Sorteio:</span> [05, 12, 23, 38, 45, 50]</p>
                                <p>‚Ä¢ <span class="font-bold">2¬∫ Sorteio:</span> [02, 15, 28, 33, 41, 47]</p>
                                <p>‚Ä¢ <span class="font-bold">N√∫meros eliminados:</span> 05, 12, 23, 38, 45, 50, 02, 15, 28, 33, 41, 47</p>
                                <p>‚Ä¢ <span class="font-bold">Dispon√≠veis:</span> 38 n√∫meros (1-50 exceto os 12 eliminados)</p>
                                <p>‚Ä¢ <span class="font-bold">Palpite gerado:</span> 2 jogos de 6 n√∫meros cada dos 38 dispon√≠veis</p>
                            </div>
                        </div>
                    </div>

                    <!-- Estrat√©gia 2 -->
                    <div class="bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-blue-800 dark:text-blue-200 mb-3">
                            üîÑ Estrat√©gia 2: Elimina√ß√£o Progressiva
                        </h3>
                        <div class="space-y-3 text-blue-700 dark:text-blue-300">
                            <p><strong>Conceito:</strong> Gera m√∫ltiplas sequ√™ncias eliminando n√∫meros j√° usados a cada rodada.</p>
                            <p><strong>L√≥gica:</strong> Maximiza as chances cobrindo diferentes combina√ß√µes sem repetir n√∫meros.</p>
                            <div class="bg-white dark:bg-gray-800 p-3 rounded border-l-4 border-blue-500">
                                <p class="font-medium mb-2">Fluxo completo:</p>
                                <div class="space-y-2 text-sm">
                                    <p>‚Ä¢ <span class="font-bold text-red-600">√öltimo concurso:</span> 12 n√∫meros eliminados ‚ùå</p>
                                    <p>‚Ä¢ <span class="font-bold text-green-600">1¬™ Sequ√™ncia:</span> 38 dispon√≠veis ‚Üí 2 jogos de 6 n√∫meros ‚ùå</p>
                                    <p>‚Ä¢ <span class="font-bold text-green-600">2¬™ Sequ√™ncia:</span> 26 dispon√≠veis ‚Üí 2 jogos de 6 n√∫meros ‚ùå</p>
                                    <p>‚Ä¢ <span class="font-bold text-green-600">3¬™ Sequ√™ncia:</span> 14 dispon√≠veis ‚Üí 2 jogos de 6 n√∫meros ‚ùå</p>
                                    <p>‚Ä¢ <span class="font-bold text-orange-600">4¬™+ Sequ√™ncias:</span> Rein√≠cio autom√°tico quando restam poucos n√∫meros</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Estrat√©gia 3 -->
                    <div class="bg-purple-50 dark:bg-purple-900 border border-purple-200 dark:border-purple-700 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-purple-800 dark:text-purple-200 mb-3">
                            üé∞ Estrat√©gia 3: Elimina√ß√£o Livre
                        </h3>
                        <div class="space-y-3 text-purple-700 dark:text-purple-300">
                            <p><strong>Conceito:</strong> Remove apenas os 12 n√∫meros do √∫ltimo concurso, mas permite repeti√ß√£o de n√∫meros entre jogos.</p>
                            <p><strong>L√≥gica:</strong> Oferece maior variedade e permite fazer mais apostas com n√∫meros favoritos.</p>
                            <div class="bg-white dark:bg-gray-800 p-3 rounded border-l-4 border-purple-500">
                                <p class="font-medium mb-2">Exemplo pr√°tico:</p>
                                <div class="space-y-2 text-sm">
                                    <p>‚Ä¢ <span class="font-bold text-red-600">N√∫meros eliminados:</span> 12 n√∫meros dos √∫ltimos sorteios ‚ùå</p>
                                    <p>‚Ä¢ <span class="font-bold">Dispon√≠veis:</span> 38 n√∫meros sempre fixos</p>
                                    <p>‚Ä¢ <span class="font-bold text-green-600">Jogo 1:</span> [01, 07, 19, 29, 31, 37] | [03, 09, 21, 25, 35, 39]</p>
                                    <p>‚Ä¢ <span class="font-bold text-green-600">Jogo 2:</span> [06, 07, 16, 29, 34, 40] | [08, 11, 21, 26, 35, 42] ‚ú® (permite repeti√ß√£o)</p>
                                    <p>‚Ä¢ <span class="font-bold text-green-600">Jogo N:</span> Sempre dos mesmos 38 n√∫meros</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Estat√≠sticas -->
                    <div class="rounded-lg p-4" style="background-color: #fde6eb; border: 1px solid #f798af;">
                        <h3 class="text-xl font-bold mb-3" style="color: #660d2b;">
                            üìä Base Estat√≠stica Dupla Sena
                        </h3>
                        <div class="space-y-2" style="color: #821136;">
                            <p>‚Ä¢ <strong>N√∫meros totais:</strong> 50 (01 a 50)</p>
                            <p>‚Ä¢ <strong>N√∫meros por sorteio:</strong> 6 cada (total 12 por concurso)</p>
                            <p>‚Ä¢ <strong>Probabilidade de repeti√ß√£o total:</strong> Praticamente 0% (1 em milh√µes)</p>
                            <p>‚Ä¢ <strong>Dupla chance:</strong> Dois sorteios independentes aumentam as chances de premia√ß√£o</p>
                            <p>‚Ä¢ <strong>Cobertura otimizada:</strong> Estrat√©gia 2 cobre 76% dos n√∫meros em 3 sequ√™ncias</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-gray-50 dark:bg-gray-800 px-6 py-4 rounded-b-lg text-center">
                    <button 
                        id="fecharModal" 
                        class="bg-purple-500 hover:bg-purple-600 text-white font-medium py-2 px-6 rounded-lg transition-colors"
                    >
                        ‚úÖ Entendi, Vamos Gerar Palpites!
                    </button>
                </div>
            </div>
        </div>

        <!-- Informa√ß√µes Adicionais -->
        <div id="infoAdicional" class="hidden mt-8 bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700 rounded-lg p-6">
            <h3 class="text-lg font-semibold text-blue-800 dark:text-blue-200 mb-4">
                üìã Informa√ß√µes do Concurso
            </h3>
            <div id="detalhes" class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-700 dark:text-blue-300">
                <!-- Detalhes ser√£o inseridos aqui -->
            </div>
        </div>
    </div>

    <script>
        // Detectar tema escuro
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // Elementos do DOM
        const concursoInicio = document.getElementById('concursoInicio');
        const concursoFim = document.getElementById('concursoFim');
        const buscarBtn = document.getElementById('buscarBtn');
        const loading = document.getElementById('loading');
        const loadingText = document.getElementById('loadingText');
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        const progressPercent = document.getElementById('progressPercent');
        const cancelarBtn = document.getElementById('cancelarBtn');
        const erro = document.getElementById('erro');
        const erroMsg = document.getElementById('erroMsg');
        const resultados = document.getElementById('resultados');
        const tabelaBody = document.getElementById('tabelaBody');
        const infoAdicional = document.getElementById('infoAdicional');
        const detalhes = document.getElementById('detalhes');
        const destacarPares = document.getElementById('destacarPares');
        const destacarImpares = document.getElementById('destacarImpares');
        const ordenarCrescente = document.getElementById('ordenarCrescente');
        const ordenarConcursoDecrescente = document.getElementById('ordenarConcursoDecrescente');

        // Vari√°veis globais
        let todosResultados = [];
        let carregamentoAtivo = false;
        let ultimoConcursoNumero = 0;

        // Vari√°veis do gerador de palpites
        let ultimoConcursoData = null;
        let numerosEliminadosGlobal = [];
        let numerosUsadosProgressivo = [];
        let sequenciaAtual = 1;
        let historicoPalpitesData = [];

        // Fun√ß√£o para formatar data
        function formatarData(dataStr) {
            if (!dataStr) return 'N/A';
            
            try {
                let data;
                
                if (dataStr instanceof Date) {
                    data = dataStr;
                } else if (typeof dataStr === 'string') {
                    if (dataStr.includes('/')) {
                        const [dia, mes, ano] = dataStr.split('/');
                        data = new Date(ano, mes - 1, dia);
                    } else if (dataStr.includes('-')) {
                        data = new Date(dataStr);
                    } else if (dataStr.length === 8 && !isNaN(dataStr)) {
                        const dia = dataStr.substr(0, 2);
                        const mes = dataStr.substr(2, 2);
                        const ano = dataStr.substr(4, 4);
                        data = new Date(ano, mes - 1, dia);
                    } else if (!isNaN(dataStr)) {
                        data = new Date(parseInt(dataStr));
                    } else {
                        data = new Date(dataStr);
                    }
                } else {
                    data = new Date(dataStr);
                }
                
                if (data && !isNaN(data.getTime())) {
                    return data.toLocaleDateString('pt-BR');
                } else {
                    return 'N/A';
                }
            } catch (error) {
                console.error('Erro ao formatar data:', dataStr, error);
                return 'N/A';
            }
        }

        // Fun√ß√£o para buscar √∫ltimo concurso de forma robusta
        async function buscarUltimoConcurso() {
            console.log('üöÄ Iniciando busca robusta do √∫ltimo concurso da Dupla Sena...');
            
            // Estrat√©gia 1: Tentar API principal m√∫ltiplas vezes
            for (let tentativa = 1; tentativa <= 3; tentativa++) {
                try {
                    console.log(`üîç Tentativa ${tentativa}: API principal...`);
                    const response = await fetch('https://servicebus2.caixa.gov.br/portaldeloterias/api/duplasena', {
                        method: 'GET',
                        headers: {
                            'Accept': 'application/json',
                            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                        }
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        if (data && data.numero && data.numero > 0) {
                            console.log(`‚úÖ Sucesso! √öltimo concurso encontrado: ${data.numero}`);
                            return data.numero;
                        }
                    }
                    
                    console.log(`‚ö†Ô∏è Tentativa ${tentativa} falhou: ${response.status}`);
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                } catch (error) {
                    console.log(`‚ùå Erro na tentativa ${tentativa}:`, error.message);
                    await new Promise(resolve => setTimeout(resolve, 1000));
                }
            }
            
            // Estrat√©gia 2: Busca sequencial reversa
            console.log('üîÑ Iniciando busca sequencial reversa...');
            
            for (let concurso = 2750; concurso >= 2700; concurso--) {
                try {
                    console.log(`üîç Testando concurso ${concurso}...`);
                    const response = await fetch(`https://servicebus2.caixa.gov.br/portaldeloterias/api/duplasena/${concurso}`);
                    
                    if (response.ok) {
                        const data = await response.json();
                        if (data && data.numero === concurso && data.dezenasSorteadasOrdemSorteio) {
                            console.log(`üéØ ENCONTRADO! √öltimo concurso v√°lido: ${concurso}`);
                            return concurso;
                        }
                    }
                    
                    await new Promise(resolve => setTimeout(resolve, 200));
                    
                } catch (error) {
                    continue;
                }
            }
            
            // Estrat√©gia 3: Fallback
            console.log('‚ö†Ô∏è Todas as estrat√©gias falharam, usando fallback...');
            const ultimoConhecido = 2700;
            console.log(`üìå Usando √∫ltimo concurso conhecido: ${ultimoConhecido}`);
            return ultimoConhecido;
        }

        // Fun√ß√£o para atualizar progresso
        function atualizarProgresso(atual, total) {
            const porcentagem = Math.round((atual / total) * 100);
            progressBar.style.width = `${porcentagem}%`;
            progressText.textContent = `${atual} / ${total} concursos`;
            progressPercent.textContent = `${porcentagem}%`;
        }

        // Fun√ß√£o para cancelar carregamento
        function cancelarCarregamento() {
            carregamentoAtivo = false;
            loading.classList.add('hidden');
            buscarBtn.disabled = false;
            loadingText.textContent = 'Carregamento cancelado';
        }

        // FUN√á√ÉO PRINCIPAL: Carregar TODOS os concursos
        async function carregarTodosOsConcursos() {
            console.log('üöÄ INICIANDO: Carregar TODOS os concursos da Dupla Sena...');
            
            loading.classList.remove('hidden');
            resultados.classList.add('hidden');
            erro.classList.add('hidden');
            infoAdicional.classList.add('hidden');
            buscarBtn.disabled = true;
            carregamentoAtivo = true;

            try {
                loadingText.textContent = 'üîç Buscando √∫ltimo concurso dispon√≠vel...';
                const ultimoConcurso = await buscarUltimoConcurso();
                
                if (!ultimoConcurso) {
                    throw new Error('N√£o foi poss√≠vel determinar o √∫ltimo concurso');
                }

                ultimoConcursoNumero = ultimoConcurso;
                concursoInicio.value = 1;
                concursoFim.value = ultimoConcurso;
                
                console.log(`‚úÖ Definido: Concurso 1 at√© ${ultimoConcurso}`);

                const totalConcursos = ultimoConcurso;
                const tamanhoBatch = 10;
                let concursosCarregados = 0;

                loadingText.textContent = `üìä Carregando TODOS os ${totalConcursos} concursos em lotes...`;
                atualizarProgresso(0, totalConcursos);

                todosResultados = [];

                for (let i = 1; i <= ultimoConcurso && carregamentoAtivo; i += tamanhoBatch) {
                    const fimBatch = Math.min(i + tamanhoBatch - 1, ultimoConcurso);
                    
                    loadingText.textContent = `üì• Carregando concursos ${i} a ${fimBatch}...`;
                    
                    const promisesBatch = [];
                    for (let j = i; j <= fimBatch; j++) {
                        promisesBatch.push(buscarConcursoComRetry(j));
                    }

                    const resultadosBatch = await Promise.allSettled(promisesBatch);
                    
                    resultadosBatch.forEach((resultado, index) => {
                        if (resultado.status === 'fulfilled' && resultado.value) {
                            todosResultados.push(resultado.value);
                        }
                        concursosCarregados++;
                        atualizarProgresso(concursosCarregados, totalConcursos);
                    });

                    if (todosResultados.length > 0) {
                        todosResultados.sort((a, b) => a.numero - b.numero);
                        exibirTodosResultados();
                    }

                    await new Promise(resolve => setTimeout(resolve, 300));
                }

                if (!carregamentoAtivo) {
                    throw new Error('Carregamento cancelado pelo usu√°rio');
                }

                todosResultados.sort((a, b) => a.numero - b.numero);

                if (todosResultados.length === 0) {
                    throw new Error('Nenhum resultado encontrado na API. Tente novamente.');
                }

                loadingText.textContent = `‚úÖ SUCESSO! Carregados ${todosResultados.length} concursos (do primeiro ao √∫ltimo)`;
                exibirTodosResultados();
                gerarResumoEstatistico();
                inicializarGeradorPalpites();
                
                console.log(`üéâ CONCLU√çDO: ${todosResultados.length} concursos carregados com sucesso!`);
                
            } catch (error) {
                console.error('‚ùå Erro ao carregar todos os concursos:', error);
                erroMsg.textContent = `Erro: ${error.message}`;
                erro.classList.remove('hidden');
            } finally {
                loading.classList.add('hidden');
                buscarBtn.disabled = false;
                carregamentoAtivo = false;
            }
        }

        // Fun√ß√£o para buscar um concurso com retry
        async function buscarConcursoComRetry(numero, tentativas = 3) {
            for (let i = 0; i < tentativas; i++) {
                try {
                    const response = await fetch(`https://servicebus2.caixa.gov.br/portaldeloterias/api/duplasena/${numero}`, {
                        timeout: 10000
                    });
                    if (!response.ok) {
                        if (i === tentativas - 1) return null;
                        await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1)));
                        continue;
                    }
                    const data = await response.json();
                    return data;
                } catch (error) {
                    console.error(`Tentativa ${i + 1} falhou para concurso ${numero}:`, error);
                    if (i === tentativas - 1) return null;
                    await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1)));
                }
            }
            return null;
        }

        // üéØ FUN√á√ÉO CORRIGIDA PARA CRIAR C√âLULA DE N√öMERO
        function criarCelulaNumero(numero, sorteio) {
            const cellNumero = document.createElement('td');
            cellNumero.className = 'px-1 py-3 whitespace-nowrap text-center';
            
            const divNumero = document.createElement('div');
            divNumero.textContent = numero.toString().padStart(2, '0'); // Sempre com 2 d√≠gitos (01, 02, etc.)
            divNumero.dataset.numero = numero;
            
            // Adicionar classe do sorteio
            divNumero.classList.add(`sorteio-${sorteio}`);

            // Aplicar cores baseado em par/√≠mpar
            aplicarDestaque(divNumero, parseInt(numero));

            cellNumero.appendChild(divNumero);
            return cellNumero;
        }

        // Fun√ß√£o para aplicar destaque par/√≠mpar
        function aplicarDestaque(elemento, numero) {
            elemento.classList.remove('numero-par', 'numero-impar');
            
            if (destacarPares.checked && numero % 2 === 0) {
                elemento.classList.add('numero-par');
            } else if (destacarImpares.checked && numero % 2 === 1) {
                elemento.classList.add('numero-impar');
            }
        }

        // Fun√ß√£o para calcular estat√≠sticas par/√≠mpar
        function calcularEstatisticasParImpar(numeros) {
            if (!numeros || !Array.isArray(numeros)) {
                return { pares: 0, impares: 0, texto: 'N/A' };
            }
            
            let pares = 0;
            let impares = 0;
            
            numeros.forEach(numero => {
                if (parseInt(numero) % 2 === 0) {
                    pares++;
                } else {
                    impares++;
                }
            });
            
            return { 
                pares, 
                impares, 
                texto: `${pares}P/${impares}I`,
                maioria: pares > impares ? 'pares' : (impares > pares ? 'impares' : 'equilibrado')
            };
        }

        // üéØ FUN√á√ÉO CORRIGIDA PARA EXIBIR RESULTADOS COM EXATAMENTE 6 N√öMEROS POR SORTEIO
        function exibirTodosResultados() {
            tabelaBody.innerHTML = '';

            const resultadosParaExibir = [...todosResultados].sort((a, b) => {
                if (ordenarConcursoDecrescente.checked) {
                    return b.numero - a.numero;
                } else {
                    return a.numero - b.numero;
                }
            });

            resultadosParaExibir.forEach(data => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700';
                row.dataset.concurso = data.numero;

                // N√∫mero do concurso
                const cellConcurso = document.createElement('td');
                cellConcurso.className = 'px-3 py-3 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white';
                cellConcurso.textContent = data.numero;
                row.appendChild(cellConcurso);

                // Data do sorteio
                const cellData = document.createElement('td');
                cellData.className = 'px-3 py-3 whitespace-nowrap text-sm text-gray-700 dark:text-gray-300';
                
                const dataFormatada = formatarData(data.dataApuracao) || 
                                    formatarData(data.dataSorteio) || 
                                    formatarData(data.data) || 
                                    'N/A';
                                    
                cellData.textContent = dataFormatada;
                row.appendChild(cellData);

                // üéØ 1¬∫ SORTEIO - GARANTIR EXATAMENTE 6 N√öMEROS
                if (data.dezenasSorteadasOrdemSorteio && Array.isArray(data.dezenasSorteadasOrdemSorteio)) {
                    let primeiraSena = [...data.dezenasSorteadasOrdemSorteio];
                    
                    // üî• GARANTIR QUE S√ÉO EXATAMENTE 6 N√öMEROS
                    if (primeiraSena.length > 6) {
                        console.warn(`Concurso ${data.numero}: 1¬∫ sorteio tem ${primeiraSena.length} n√∫meros, limitando a 6`);
                        primeiraSena = primeiraSena.slice(0, 6);
                    }
                    
                    if (ordenarCrescente.checked) {
                        primeiraSena.sort((a, b) => parseInt(a) - parseInt(b));
                    }
                    
                    // Sempre criar exatamente 6 c√©lulas para o 1¬∫ sorteio
                    for (let i = 0; i < 6; i++) {
                        if (i < primeiraSena.length && primeiraSena[i]) {
                            const cellNumero = criarCelulaNumero(primeiraSena[i], 1);
                            cellNumero.dataset.sorteio = '1';
                            cellNumero.dataset.posicao = i + 1;
                            row.appendChild(cellNumero);
                        } else {
                            // Criar c√©lula vazia se n√£o tiver n√∫mero suficiente
                            const cellVazia = document.createElement('td');
                            cellVazia.className = 'px-1 py-3 whitespace-nowrap text-center';
                            cellVazia.dataset.sorteio = '1';
                            cellVazia.dataset.posicao = i + 1;
                            cellVazia.innerHTML = '<div class="w-10 h-10 border border-gray-300 rounded-full bg-gray-50"></div>';
                            row.appendChild(cellVazia);
                        }
                    }
                } else {
                    // Se n√£o tiver dados, criar 6 c√©lulas vazias
                    for (let i = 0; i < 6; i++) {
                        const cellVazia = document.createElement('td');
                        cellVazia.className = 'px-1 py-3 whitespace-nowrap text-center';
                        cellVazia.dataset.sorteio = '1';
                        cellVazia.dataset.posicao = i + 1;
                        cellVazia.innerHTML = '<div class="w-10 h-10 border border-gray-300 rounded-full bg-gray-50"></div>';
                        row.appendChild(cellVazia);
                    }
                }

                // Separador visual
                const cellSeparador = document.createElement('td');
                cellSeparador.className = 'px-0 py-3 w-1 separador-sorteios';
                row.appendChild(cellSeparador);

                // üéØ 2¬∫ SORTEIO - GARANTIR EXATAMENTE 6 N√öMEROS
                if (data.listaDezenasSegundoSorteio && Array.isArray(data.listaDezenasSegundoSorteio)) {
                    let segundaSena = [...data.listaDezenasSegundoSorteio];
                    
                    // üî• GARANTIR QUE S√ÉO EXATAMENTE 6 N√öMEROS
                    if (segundaSena.length > 6) {
                        console.warn(`Concurso ${data.numero}: 2¬∫ sorteio tem ${segundaSena.length} n√∫meros, limitando a 6`);
                        segundaSena = segundaSena.slice(0, 6);
                    }
                    
                    if (ordenarCrescente.checked) {
                        segundaSena.sort((a, b) => parseInt(a) - parseInt(b));
                    }
                    
                    // Sempre criar exatamente 6 c√©lulas para o 2¬∫ sorteio
                    for (let i = 0; i < 6; i++) {
                        if (i < segundaSena.length && segundaSena[i]) {
                            const cellNumero = criarCelulaNumero(segundaSena[i], 2);
                            cellNumero.dataset.sorteio = '2';
                            cellNumero.dataset.posicao = i + 1;
                            row.appendChild(cellNumero);
                        } else {
                            // Criar c√©lula vazia se n√£o tiver n√∫mero suficiente
                            const cellVazia = document.createElement('td');
                            cellVazia.className = 'px-1 py-3 whitespace-nowrap text-center';
                            cellVazia.dataset.sorteio = '2';
                            cellVazia.dataset.posicao = i + 1;
                            cellVazia.innerHTML = '<div class="w-10 h-10 border border-gray-300 rounded-full bg-gray-50"></div>';
                            row.appendChild(cellVazia);
                        }
                    }
                } else {
                    // Se n√£o tiver dados, criar 6 c√©lulas vazias
                    for (let i = 0; i < 6; i++) {
                        const cellVazia = document.createElement('td');
                        cellVazia.className = 'px-1 py-3 whitespace-nowrap text-center';
                        cellVazia.dataset.sorteio = '2';
                        cellVazia.dataset.posicao = i + 1;
                        cellVazia.innerHTML = '<div class="w-10 h-10 border border-gray-300 rounded-full bg-gray-50"></div>';
                        row.appendChild(cellVazia);
                    }
                }

                // Estat√≠sticas Par/√çmpar (total dos dois sorteios)
                const cellEstatisticas = document.createElement('td');
                cellEstatisticas.className = 'px-3 py-3 whitespace-nowrap text-center';
                
                const primeiros = (data.dezenasSorteadasOrdemSorteio || []).slice(0, 6);
                const segundos = (data.listaDezenasSegundoSorteio || []).slice(0, 6);
                
                // üî• GARANTIR M√ÅXIMO 6 N√öMEROS DE CADA SORTEIO PARA ESTAT√çSTICAS
                const todosNumeros = [...primeiros, ...segundos];
                
                const stats = calcularEstatisticasParImpar(todosNumeros);
                const spanStats = document.createElement('span');
                spanStats.className = 'inline-flex items-center px-2 py-1 text-xs font-bold rounded-full';
                
                // Cores baseadas na maioria
                if (stats.maioria === 'pares') {
                    spanStats.className += ' bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200';
                } else if (stats.maioria === 'impares') {
                    spanStats.className += ' bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200';
                } else {
                    spanStats.className += ' bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200';
                }
                
                spanStats.textContent = stats.texto;
                spanStats.title = `${stats.pares} n√∫meros pares e ${stats.impares} n√∫meros √≠mpares (ambos sorteios)`;
                
                cellEstatisticas.appendChild(spanStats);
                row.appendChild(cellEstatisticas);

                tabelaBody.appendChild(row);
            });

            resultados.classList.remove('hidden');
            document.getElementById('toggleTabelaContainer').classList.remove('hidden');
            aplicarFiltros();
        }

        // Fun√ß√£o para aplicar filtros
        function aplicarFiltros() {
            const filtros1 = []; // 1¬∫ sorteio
            const filtros2 = []; // 2¬∫ sorteio
            
            for (let i = 1; i <= 6; i++) {
                const filtro1 = document.getElementById(`filtro1_${i}`).value.trim();
                const filtro2 = document.getElementById(`filtro2_${i}`).value.trim();
                filtros1.push(filtro1);
                filtros2.push(filtro2);
            }

            const rows = tabelaBody.querySelectorAll('tr');
            let resultadosVisiveis = 0;
            
            rows.forEach(row => {
                let mostrar = true;
                
                // Verificar filtros do 1¬∫ sorteio
                filtros1.forEach((filtro, index) => {
                    if (filtro) {
                        const celulas = row.querySelectorAll(`td[data-sorteio="1"][data-posicao="${index + 1}"]`);
                        if (celulas.length > 0) {
                            const numeroElement = celulas[0].querySelector('[data-numero]');
                            if (numeroElement) {
                                const numero = numeroElement.textContent.trim();
                                if (!numero.includes(filtro)) {
                                    mostrar = false;
                                }
                            }
                        }
                    }
                });
                
                // Verificar filtros do 2¬∫ sorteio
                filtros2.forEach((filtro, index) => {
                    if (filtro && mostrar) {
                        const celulas = row.querySelectorAll(`td[data-sorteio="2"][data-posicao="${index + 1}"]`);
                        if (celulas.length > 0) {
                            const numeroElement = celulas[0].querySelector('[data-numero]');
                            if (numeroElement) {
                                const numero = numeroElement.textContent.trim();
                                if (!numero.includes(filtro)) {
                                    mostrar = false;
                                }
                            }
                        }
                    }
                });

                row.style.display = mostrar ? '' : 'none';
                if (mostrar) {
                    resultadosVisiveis++;
                }
            });

            atualizarContador(resultadosVisiveis, todosResultados.length);
        }

        // Fun√ß√£o para atualizar contador de resultados
        function atualizarContador(visiveis, total) {
            const contador = document.getElementById('contadorResultados');
            if (visiveis === total) {
                contador.textContent = `üìä ${total} concursos carregados (COMPLETO)`;
            } else {
                contador.textContent = `üìä ${visiveis} de ${total} concursos (filtrado)`;
            }
        }

        // Fun√ß√£o para atualizar destaques
        function atualizarDestaques() {
            const numeros = document.querySelectorAll('[data-numero]');
            numeros.forEach(elemento => {
                const numero = parseInt(elemento.dataset.numero);
                aplicarDestaque(elemento, numero);
            });
        }

        // Event listeners
        buscarBtn.addEventListener('click', carregarTodosOsConcursos);
        cancelarBtn.addEventListener('click', cancelarCarregamento);
        
        // Event listeners para filtros
        for (let s = 1; s <= 2; s++) {
            for (let i = 1; i <= 6; i++) {
                const filtro = document.getElementById(`filtro${s}_${i}`);
                filtro.addEventListener('input', aplicarFiltros);
            }
        }

        destacarPares.addEventListener('change', atualizarDestaques);
        destacarImpares.addEventListener('change', atualizarDestaques);
        
        ordenarCrescente.addEventListener('change', () => {
            if (todosResultados.length > 0) {
                exibirTodosResultados();
                gerarResumoEstatistico();
            }
        });

        ordenarConcursoDecrescente.addEventListener('change', () => {
            if (todosResultados.length > 0) {
                exibirTodosResultados();
            }
        });

        concursoInicio.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') carregarTodosOsConcursos();
        });
        
        concursoFim.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') carregarTodosOsConcursos();
        });

        // Fun√ß√£o para gerar resumo estat√≠stico
        function gerarResumoEstatistico() {
            if (todosResultados.length === 0) return;

            const resumoDiv = document.getElementById('resumoEstatistico');
            const estatisticasDiv = document.getElementById('estatisticasGerais');
            const graficoDiv = document.getElementById('graficoBarras');
            const dadosSorteios = document.getElementById('dadosSorteios');
            const padroesDiv = document.getElementById('padroes');

            // Calcular estat√≠sticas
            let totalPares = 0, totalImpares = 0;
            let concursosMaioriaPares = 0, concursosMaioriaImpares = 0, concursosEquilibrados = 0;
            const padroesCombinacoes = {};

            todosResultados.forEach(resultado => {
                const primeiros = (resultado.dezenasSorteadasOrdemSorteio || []).slice(0, 6);
                const segundos = (resultado.listaDezenasSegundoSorteio || []).slice(0, 6);
                const todosNumeros = [...primeiros, ...segundos];
                
                const stats = calcularEstatisticasParImpar(todosNumeros);
                totalPares += stats.pares;
                totalImpares += stats.impares;

                if (stats.maioria === 'pares') concursosMaioriaPares++;
                else if (stats.maioria === 'impares') concursosMaioriaImpares++;
                else concursosEquilibrados++;

                const padrao = stats.texto;
                padroesCombinacoes[padrao] = (padroesCombinacoes[padrao] || 0) + 1;
            });

            const totalConcursos = todosResultados.length;
            const percPares = ((concursosMaioriaPares / totalConcursos) * 100).toFixed(1);
            const percImpares = ((concursosMaioriaImpares / totalConcursos) * 100).toFixed(1);
            const percEquilibrados = ((concursosEquilibrados / totalConcursos) * 100).toFixed(1);

            // Cards estat√≠sticos
            estatisticasDiv.innerHTML = `
                <div class="bg-blue-50 dark:bg-blue-900 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-blue-600 dark:text-blue-300">${concursosMaioriaPares}</div>
                    <div class="text-sm text-blue-800 dark:text-blue-200">Concursos com</div>
                    <div class="text-sm font-semibold text-blue-800 dark:text-blue-200">Maioria Pares</div>
                    <div class="text-xs text-blue-600 dark:text-blue-400">${percPares}%</div>
                </div>
                <div class="p-4 rounded-lg text-center" style="background-color: #fde6eb;">
                    <div class="text-2xl font-bold" style="color: #ba184a;">${concursosMaioriaImpares}</div>
                    <div class="text-sm" style="color: #660d2b;">Concursos com</div>
                    <div class="text-sm font-semibold" style="color: #660d2b;">Maioria √çmpares</div>
                    <div class="text-xs" style="color: #821136;">${percImpares}%</div>
                </div>
                <div class="bg-purple-50 dark:bg-purple-900 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-purple-600 dark:text-purple-300">${concursosEquilibrados}</div>
                    <div class="text-sm text-purple-800 dark:text-purple-200">Concursos</div>
                    <div class="text-sm font-semibold text-purple-800 dark:text-purple-200">Equilibrados</div>
                    <div class="text-xs text-purple-600 dark:text-purple-400">${percEquilibrados}%</div>
                </div>
                <div class="p-4 rounded-lg text-center" style="background-color: #fcd9e1;">
                    <div class="text-lg font-bold" style="color: #ba184a;">${totalPares}P / ${totalImpares}I</div>
                    <div class="text-sm" style="color: #660d2b;">Total de</div>
                    <div class="text-sm font-semibold" style="color: #660d2b;">N√∫meros Sorteados</div>
                    <div class="text-xs" style="color: #821136;">${totalConcursos} concursos</div>
                </div>
            `;

            // Gr√°fico de barras visual
            const maxValor = Math.max(concursosMaioriaPares, concursosMaioriaImpares, concursosEquilibrados);
            graficoDiv.innerHTML = `
                <div class="flex items-center">
                    <div class="w-20 text-sm text-gray-600 dark:text-gray-400">Maioria Pares:</div>
                    <div class="flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-6 mx-3">
                        <div class="bg-blue-500 h-6 rounded-full flex items-center justify-end pr-2" style="width: ${(concursosMaioriaPares/maxValor)*100}%">
                            <span class="text-xs text-white font-bold">${concursosMaioriaPares}</span>
                        </div>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-20 text-sm text-gray-600 dark:text-gray-400">Maioria √çmpares:</div>
                    <div class="flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-6 mx-3">
                        <div class="h-6 rounded-full flex items-center justify-end pr-2" style="background-color: #ba184a; width: ${(concursosMaioriaImpares/maxValor)*100}%">
                            <span class="text-xs text-white font-bold">${concursosMaioriaImpares}</span>
                        </div>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-20 text-sm text-gray-600 dark:text-gray-400">Equilibrados:</div>
                    <div class="flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-6 mx-3">
                        <div class="bg-purple-500 h-6 rounded-full flex items-center justify-end pr-2" style="width: ${(concursosEquilibrados/maxValor)*100}%">
                            <span class="text-xs text-white font-bold">${concursosEquilibrados}</span>
                        </div>
                    </div>
                </div>
            `;

            // Compara√ß√£o entre sorteios
            let stats1 = { pares: 0, impares: 0 };
            let stats2 = { pares: 0, impares: 0 };
            
            todosResultados.forEach(resultado => {
                if (resultado.dezenasSorteadasOrdemSorteio) {
                    const s1 = calcularEstatisticasParImpar(resultado.dezenasSorteadasOrdemSorteio.slice(0, 6));
                    stats1.pares += s1.pares;
                    stats1.impares += s1.impares;
                }
                if (resultado.listaDezenasSegundoSorteio) {
                    const s2 = calcularEstatisticasParImpar(resultado.listaDezenasSegundoSorteio.slice(0, 6));
                    stats2.pares += s2.pares;
                    stats2.impares += s2.impares;
                }
            });

            dadosSorteios.innerHTML = `
                <div class="primeiro-sorteio p-4 rounded-lg">
                    <h5 class="font-bold mb-3 text-center" style="color: #660d2b;">üéØ 1¬∫ Sorteio</h5>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="text-center">
                            <div class="text-2xl font-bold text-blue-600">${stats1.pares}</div>
                            <div class="text-sm text-blue-800">Pares</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold" style="color: #ba184a;">${stats1.impares}</div>
                            <div class="text-sm" style="color: #660d2b;">√çmpares</div>
                        </div>
                    </div>
                </div>
                <div class="segundo-sorteio p-4 rounded-lg">
                    <h5 class="font-bold mb-3 text-center" style="color: #660d2b;">üé≤ 2¬∫ Sorteio</h5>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="text-center">
                            <div class="text-2xl font-bold text-blue-600">${stats2.pares}</div>
                            <div class="text-sm text-blue-800">Pares</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold" style="color: #ba184a;">${stats2.impares}</div>
                            <div class="text-sm" style="color: #660d2b;">√çmpares</div>
                        </div>
                    </div>
                </div>
            `;

            // Padr√µes mais comuns
            const padroesOrdenados = Object.entries(padroesCombinacoes)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 10);

            let padroesMaisComuns = '<div class="grid grid-cols-2 md:grid-cols-5 gap-2 mb-4">';
            padroesOrdenados.forEach(([padrao, count]) => {
                const perc = ((count / totalConcursos) * 100).toFixed(1);
                padroesMaisComuns += `
                    <div class="bg-gray-100 dark:bg-gray-700 p-2 rounded text-center">
                        <div class="font-bold text-sm">${padrao}</div>
                        <div class="text-xs text-gray-600 dark:text-gray-400">${count}x (${perc}%)</div>
                    </div>
                `;
            });
            padroesMaisComuns += '</div>';

            // An√°lises e insights
            let insights = '';
            if (concursosMaioriaPares > concursosMaioriaImpares) {
                const diferenca = concursosMaioriaPares - concursosMaioriaImpares;
                insights += `<p><strong>üîç Tend√™ncia:</strong> H√° uma ligeira tend√™ncia para concursos com maioria de n√∫meros pares (${diferenca} concursos a mais).</p>`;
            } else if (concursosMaioriaImpares > concursosMaioriaPares) {
                const diferenca = concursosMaioriaImpares - concursosMaioriaPares;
                insights += `<p><strong>üîç Tend√™ncia:</strong> H√° uma ligeira tend√™ncia para concursos com maioria de n√∫meros √≠mpares (${diferenca} concursos a mais).</p>`;
            } else {
                insights += `<p><strong>üîç Equil√≠brio:</strong> Os concursos est√£o perfeitamente equilibrados entre maioria pares e √≠mpares.</p>`;
            }

            const padraoMaisComum = padroesOrdenados[0];
            if (padraoMaisComum) {
                insights += `<p><strong>üìä Padr√£o mais comum:</strong> ${padraoMaisComum[0]} apareceu em ${padraoMaisComum[1]} concursos (${((padraoMaisComum[1]/totalConcursos)*100).toFixed(1)}%).</p>`;
            }

            insights += `<p><strong>üéØ Dupla Sena:</strong> Cada sorteio tem exatamente 6 n√∫meros √∫nicos (1-50), oferecendo dupla chance de premia√ß√£o.</p>`;

            padroesDiv.innerHTML = padroesMaisComuns + insights;

            // Gerar an√°lise visual
            const jogos = parseInt(document.getElementById('jogosAnalisar').value) || 50;
            if (todosResultados.length >= jogos) {
                gerarAnaliseVisual(jogos);
            }

            resumoDiv.classList.remove('hidden');
        }

        // Fun√ß√£o para gerar an√°lise visual
        function gerarAnaliseVisual(jogosAnalisar = 50) {
            if (todosResultados.length < jogosAnalisar) return;

            const ultimosConcursos = [...todosResultados]
                .sort((a, b) => b.numero - a.numero)
                .slice(0, jogosAnalisar);

            // Analisar 1¬∫ sorteio
            const numeros1 = new Set();
            ultimosConcursos.forEach(concurso => {
                if (concurso.dezenasSorteadasOrdemSorteio) {
                    concurso.dezenasSorteadasOrdemSorteio.slice(0, 6).forEach(num => {
                        numeros1.add(parseInt(num));
                    });
                }
            });

            // Analisar 2¬∫ sorteio
            const numeros2 = new Set();
            ultimosConcursos.forEach(concurso => {
                if (concurso.listaDezenasSegundoSorteio) {
                    concurso.listaDezenasSegundoSorteio.slice(0, 6).forEach(num => {
                        numeros2.add(parseInt(num));
                    });
                }
            });

            // Gerar tabela para 1¬∫ sorteio
            let html1 = `
                <thead style="background-color: #fcd9e1;">
                    <tr><th colspan="10" class="text-center text-xs font-bold py-2" style="color: #660d2b;">üéØ N√∫meros que sa√≠ram no 1¬∫ Sorteio</th></tr>
                    <tr>`;
            
            for (let i = 1; i <= 10; i++) {
                html1 += `<th class="px-1 py-1 text-center text-xs font-bold border" style="border-color: #f798af;">${i}</th>`;
            }
            html1 += `</tr></thead><tbody>`;
            
            for (let linha = 0; linha < 5; linha++) {
                html1 += '<tr>';
                for (let col = 0; col < 10; col++) {
                    const num = linha * 10 + col + 1;
                    const saiu = numeros1.has(num);
                    html1 += `<td class="px-1 py-1 text-center border text-xs font-bold" style="border-color: #f798af; ${saiu ? 'background-color: #ba184a; color: white;' : ''}">${saiu ? num : ''}</td>`;
                }
                html1 += '</tr>';
            }
            html1 += '</tbody>';
            document.getElementById('tabelaAnalise1').innerHTML = html1;
            document.getElementById('resumoAnalise1').textContent = `${numeros1.size}/50 n√∫meros sa√≠ram`;

            // Gerar tabela para 2¬∫ sorteio
            let html2 = `
                <thead style="background-color: #e1c9f7;">
                    <tr><th colspan="10" class="text-center text-xs font-bold py-2" style="color: #4a1a5b;">üé≤ N√∫meros que sa√≠ram no 2¬∫ Sorteio</th></tr>
                    <tr>`;
            
            for (let i = 1; i <= 10; i++) {
                html2 += `<th class="px-1 py-1 text-center text-xs font-bold border" style="border-color: #7c3aed;">${i}</th>`;
            }
            html2 += `</tr></thead><tbody>`;
            
            for (let linha = 0; linha < 5; linha++) {
                html2 += '<tr>';
                for (let col = 0; col < 10; col++) {
                    const num = linha * 10 + col + 1;
                    const saiu = numeros2.has(num);
                    html2 += `<td class="px-1 py-1 text-center border text-xs font-bold" style="border-color: #7c3aed; ${saiu ? 'background-color: #7c3aed; color: white;' : ''}">${saiu ? num : ''}</td>`;
                }
                html2 += '</tr>';
            }
            html2 += '</tbody>';
            document.getElementById('tabelaAnalise2').innerHTML = html2;
            document.getElementById('resumoAnalise2').textContent = `${numeros2.size}/50 n√∫meros sa√≠ram`;

            // N√∫meros que n√£o sa√≠ram
            const naoSairam1 = [];
            const naoSairam2 = [];
            for (let i = 1; i <= 50; i++) {
                if (!numeros1.has(i)) naoSairam1.push(i);
                if (!numeros2.has(i)) naoSairam2.push(i);
            }

            document.getElementById('numerosNaoSairam').innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-3 rounded border-l-4 border-primary">
                    <h6 class="font-bold mb-2" style="color: #ba184a;">üéØ 1¬∫ Sorteio - N√£o sa√≠ram:</h6>
                    <div class="text-sm text-gray-700 dark:text-gray-300">${naoSairam1.join(', ') || 'Todos sa√≠ram'}</div>
                </div>
                <div class="bg-white dark:bg-gray-800 p-3 rounded border-l-4 border-purple-500">
                    <h6 class="font-bold mb-2 text-purple-800 dark:text-purple-200">üé≤ 2¬∫ Sorteio - N√£o sa√≠ram:</h6>
                    <div class="text-sm text-gray-700 dark:text-gray-300">${naoSairam2.join(', ') || 'Todos sa√≠ram'}</div>
                </div>
            `;

            document.getElementById('jogosEscolhidos').textContent = jogosAnalisar;
            document.getElementById('analiseVisual').classList.remove('hidden');
        }

        // Event listeners para an√°lise visual
        document.getElementById('atualizarAnalise').addEventListener('click', () => {
            const jogos = parseInt(document.getElementById('jogosAnalisar').value) || 50;
            if (jogos < 1 || jogos > 100) {
                mostrarModal('Erro', 'Por favor, insira um valor entre 1 e 100 jogos.');
                return;
            }
            if (todosResultados.length < jogos) {
                mostrarModal('Dados Insuficientes', `N√£o h√° dados suficientes. Dispon√≠vel: ${todosResultados.length} jogos, Solicitado: ${jogos}`);
                return;
            }
            gerarAnaliseVisual(jogos);
        });

        document.getElementById('jogosAnalisar').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                document.getElementById('atualizarAnalise').click();
            }
        });

        // Fun√ß√£o para mostrar modal personalizada
        function mostrarModal(titulo, mensagem) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">${titulo}</h3>
                    <p class="text-gray-700 dark:text-gray-300 mb-4">${mensagem}</p>
                    <div class="flex justify-end">
                        <button class="px-4 py-2 bg-primary hover:bg-primary-dark text-white rounded" onclick="this.closest('.fixed').remove()">OK</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Event listener para toggle da tabela
        document.getElementById('toggleTabelaBtn').addEventListener('click', () => {
            const resultados = document.getElementById('resultados');
            const toggleBtn = document.getElementById('toggleTabelaBtn');
            
            if (resultados.classList.contains('hidden')) {
                resultados.classList.remove('hidden');
                toggleBtn.textContent = 'üëÅÔ∏è Ocultar Tabela de Resultados';
                toggleBtn.className = 'bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-6 rounded-lg transition-colors duration-200';
            } else {
                resultados.classList.add('hidden');
                toggleBtn.textContent = 'üëÅÔ∏è Mostrar Tabela de Resultados';
                toggleBtn.className = 'bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-6 rounded-lg transition-colors duration-200';
            }
        });

        // üéØ FUN√á√ïES DO GERADOR DE PALPITES

        // Fun√ß√£o para inicializar o gerador de palpites
        function inicializarGeradorPalpites() {
            if (todosResultados.length === 0) return;

            // Encontrar o √∫ltimo concurso (maior n√∫mero)
            ultimoConcursoData = todosResultados.reduce((ultimo, atual) => {
                return atual.numero > ultimo.numero ? atual : ultimo;
            });

            // Converter n√∫meros para inteiros - Dupla Sena tem 2 sorteios
            const primeiro = (ultimoConcursoData.dezenasSorteadasOrdemSorteio || []).slice(0, 6).map(num => parseInt(num));
            const segundo = (ultimoConcursoData.listaDezenasSegundoSorteio || []).slice(0, 6).map(num => parseInt(num));
            
            numerosEliminadosGlobal = [...primeiro, ...segundo];
            numerosUsadosProgressivo = [...numerosEliminadosGlobal];
            sequenciaAtual = 1;

            // Atualizar interface
            atualizarInfoUltimoConcurso();
            atualizarVisualizacaoNumeros();
            atualizarStatusProgressivo();

            // Mostrar se√ß√£o
            document.getElementById('geradorPalpites').classList.remove('hidden');
        }

        // Fun√ß√£o para atualizar informa√ß√µes do √∫ltimo concurso
        function atualizarInfoUltimoConcurso() {
            const dadosDiv = document.getElementById('dadosUltimoConcurso');
            
            if (!ultimoConcursoData) {
                dadosDiv.innerHTML = '<p class="text-gray-500">Nenhum dado dispon√≠vel</p>';
                return;
            }

            const primeiro = (ultimoConcursoData.dezenasSorteadasOrdemSorteio || []).slice(0, 6);
            const segundo = (ultimoConcursoData.listaDezenasSegundoSorteio || []).slice(0, 6);

            const numerosHTML1 = primeiro
                .map(num => `<span class="inline-block bg-red-100 dark:bg-red-800 text-red-800 dark:text-red-200 px-2 py-1 rounded-full text-sm font-bold mx-1">${num}</span>`)
                .join('');

            const numerosHTML2 = segundo
                .map(num => `<span class="inline-block bg-purple-100 dark:bg-purple-800 text-purple-800 dark:text-purple-200 px-2 py-1 rounded-full text-sm font-bold mx-1">${num}</span>`)
                .join('');

            const dataFormatada = formatarData(ultimoConcursoData.dataApuracao) || 
                                formatarData(ultimoConcursoData.dataSorteio) || 
                                'N/A';

            dadosDiv.innerHTML = `
                <div class="space-y-4">
                    <div class="text-lg font-semibold text-gray-800 dark:text-gray-200">
                        Concurso: <span class="text-purple-600 dark:text-purple-400">${ultimoConcursoData.numero}</span>
                    </div>
                    <div class="text-sm text-gray-600 dark:text-gray-400">
                        Data: ${dataFormatada}
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="primeiro-sorteio p-3 rounded-lg">
                            <div class="text-sm font-semibold mb-2" style="color: #660d2b;">üéØ 1¬∫ Sorteio:</div>
                            <div class="flex flex-wrap gap-1">
                                ${numerosHTML1}
                            </div>
                        </div>
                        
                        <div class="segundo-sorteio p-3 rounded-lg">
                            <div class="text-sm font-semibold mb-2" style="color: #660d2b;">üé≤ 2¬∫ Sorteio:</div>
                            <div class="flex flex-wrap gap-1">
                                ${numerosHTML2}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Fun√ß√£o para atualizar visualiza√ß√£o dos n√∫meros
        function atualizarVisualizacaoNumeros() {
            const eliminadosDiv = document.getElementById('numerosEliminados');
            const disponiveisDiv = document.getElementById('numerosDisponiveis');
            
            // N√∫meros eliminados
            const eliminadosHTML = numerosUsadosProgressivo
                .sort((a, b) => a - b)
                .map(num => `<span class="numero-eliminado px-2 py-1 rounded-full text-sm font-bold">${num}</span>`)
                .join('');
            
            eliminadosDiv.innerHTML = eliminadosHTML || '<span class="text-gray-500 text-sm">Nenhum n√∫mero eliminado</span>';
            
            // N√∫meros dispon√≠veis
            const todosNumeros = Array.from({length: 50}, (_, i) => i + 1);
            const numerosDisponiveis = todosNumeros.filter(num => !numerosUsadosProgressivo.includes(num));
            
            const disponiveisHTML = numerosDisponiveis
                .map(num => `<span class="numero-disponivel px-2 py-1 rounded-full text-sm font-bold">${num}</span>`)
                .join('');
            
            disponiveisDiv.innerHTML = disponiveisHTML || '<span class="text-gray-500 text-sm">Nenhum n√∫mero dispon√≠vel</span>';
        }

        // Fun√ß√£o para atualizar status da estrat√©gia progressiva
        function atualizarStatusProgressivo() {
            const statusDiv = document.getElementById('statusProgressivo');
            const todosNumeros = Array.from({length: 50}, (_, i) => i + 1);
            const numerosDisponiveis = todosNumeros.filter(num => !numerosUsadosProgressivo.includes(num));
            const maxSequencias = Math.floor(38 / 12) + 1; // 38 dispon√≠veis / 12 por sequ√™ncia
            
            statusDiv.textContent = `Sequ√™ncia: ${sequenciaAtual}/${maxSequencias} | Dispon√≠veis: ${numerosDisponiveis.length}`;
        }

        // Fun√ß√£o para gerar n√∫meros aleat√≥rios √∫nicos
        function gerarNumerosAleatorios(pool, quantidade) {
            if (pool.length < quantidade) {
                return pool.slice();
            }
            
            const resultado = [];
            const poolCopia = [...pool];
            
            while (resultado.length < quantidade && poolCopia.length > 0) {
                const indiceAleatorio = Math.floor(Math.random() * poolCopia.length);
                resultado.push(poolCopia.splice(indiceAleatorio, 1)[0]);
            }
            
            return resultado.sort((a, b) => a - b);
        }

        // Fun√ß√£o para formatar n√∫mero com zeros √† esquerda
        function formatarNumero(num) {
            return num.toString().padStart(2, '0');
        }

        // Fun√ß√£o para classificar n√∫meros por faixas (Dupla Sena: 1-50)
        function classificarNumeros(numeros) {
            const baixas = []; // 01-17
            const medias = []; // 18-33  
            const altas = [];  // 34-50
            
            numeros.forEach(num => {
                if (num >= 1 && num <= 17) {
                    baixas.push(num);
                } else if (num >= 18 && num <= 33) {
                    medias.push(num);
                } else if (num >= 34 && num <= 50) {
                    altas.push(num);
                }
            });
            
            return { baixas, medias, altas };
        }

        // Fun√ß√£o para gerar jogo equilibrado (estrat√©gia inteligente)
        function gerarJogoEquilibrado(numerosDisponiveis) {
            const classificacao = classificarNumeros(numerosDisponiveis);
            const jogo = [];
            
            // Tentar distribui√ß√£o equilibrada: 2 baixas, 2 m√©dias, 2 altas
            const distribuicao = [
                { faixa: 'baixas', quantidade: Math.min(2, classificacao.baixas.length) },
                { faixa: 'medias', quantidade: Math.min(2, classificacao.medias.length) },
                { faixa: 'altas', quantidade: Math.min(2, classificacao.altas.length) }
            ];
            
            // Ajustar distribui√ß√£o para totalizar 6 n√∫meros
            let totalEscolhido = distribuicao.reduce((sum, d) => sum + d.quantidade, 0);
            
            // Se temos menos de 6, adicionar mais onde poss√≠vel
            while (totalEscolhido < 6) {
                for (let dist of distribuicao) {
                    const disponiveisNaFaixa = classificacao[dist.faixa].length;
                    if (dist.quantidade < disponiveisNaFaixa && totalEscolhido < 6) {
                        dist.quantidade++;
                        totalEscolhido++;
                    }
                }
                break;
            }
            
            // Se ainda temos mais de 6, reduzir
            while (totalEscolhido > 6) {
                for (let dist of distribuicao.reverse()) {
                    if (dist.quantidade > 0 && totalEscolhido > 6) {
                        dist.quantidade--;
                        totalEscolhido--;
                    }
                }
                break;
            }
            
            // Escolher n√∫meros de cada faixa
            distribuicao.forEach(dist => {
                const numerosEscolhidos = gerarNumerosAleatorios(classificacao[dist.faixa], dist.quantidade);
                jogo.push(...numerosEscolhidos);
            });
            
            return jogo.sort((a, b) => a - b);
        }

        // Fun√ß√£o para estrat√©gia 1: Elimina√ß√£o simples
        function gerarEstrategia1() {
            if (!ultimoConcursoData) {
                mostrarModal('Erro', 'Nenhum dado de concurso dispon√≠vel.');
                return;
            }

            const quantidadeJogos = parseInt(document.getElementById('quantidadeJogos1').value) || 1;
            
            // Validar quantidade
            if (quantidadeJogos < 1 || quantidadeJogos > 38) {
                mostrarModal('Erro', 'Quantidade deve ser entre 1 e 38 jogos por sorteio.');
                return;
            }

            const todosNumeros = Array.from({length: 50}, (_, i) => i + 1);
            
            // Pool de n√∫meros dispon√≠veis (1-50 exceto os 12 do √∫ltimo concurso)
            const numerosDisponiveis = todosNumeros.filter(num => !numerosEliminadosGlobal.includes(num));
            
            // Verificar se √© poss√≠vel gerar a quantidade solicitada
            const maxJogosPorSorteio = Math.floor(numerosDisponiveis.length / 6);
            if (quantidadeJogos > maxJogosPorSorteio) {
                mostrarModal('Erro', `M√°ximo poss√≠vel: ${maxJogosPorSorteio} jogos √∫nicos por sorteio com ${numerosDisponiveis.length} n√∫meros dispon√≠veis.`);
                return;
            }
            
            // Gerar m√∫ltiplos jogos para cada sorteio
            const jogosGerados = { primeiro: [], segundo: [] };
            const numerosJaUsados = new Set();
            
            for (let i = 0; i < quantidadeJogos; i++) {
                // Pool dispon√≠vel para este jogo
                const poolDisponivel = numerosDisponiveis.filter(num => !numerosJaUsados.has(num));
                
                if (poolDisponivel.length < 12) { // Precisa de 12 n√∫meros (6 para cada sorteio)
                    break;
                }
                
                // Gerar 1¬∫ sorteio
                const jogo1 = gerarJogoEquilibrado(poolDisponivel);
                jogosGerados.primeiro.push(jogo1);
                jogo1.forEach(num => numerosJaUsados.add(num));
                
                // Pool atualizado para o 2¬∫ sorteio
                const poolRestante = numerosDisponiveis.filter(num => !numerosJaUsados.has(num));
                
                // Gerar 2¬∫ sorteio
                const jogo2 = gerarJogoEquilibrado(poolRestante);
                jogosGerados.segundo.push(jogo2);
                jogo2.forEach(num => numerosJaUsados.add(num));
            }
            
            // Adicionar ao hist√≥rico
            const horario = new Date().toLocaleTimeString('pt-BR');
            const novoPalpite = {
                id: Date.now(),
                estrategia: 1,
                jogos: jogosGerados,
                quantidade: jogosGerados.primeiro.length,
                horario: horario,
                info: `${jogosGerados.primeiro.length} jogos duplos - Eliminou concurso ${ultimoConcursoData.numero}`
            };
            
            historicoPalpitesData.unshift(novoPalpite);
            
            // Atualizar interface
            exibirResultadoEstrategia1(jogosGerados);
            atualizarHistoricoPalpites();
        }

        // Fun√ß√£o para estrat√©gia 3: Elimina√ß√£o livre (permite repeti√ß√µes)
        function gerarEstrategia3() {
            if (!ultimoConcursoData) {
                mostrarModal('Erro', 'Nenhum dado de concurso dispon√≠vel.');
                return;
            }

            const quantidadeJogos = parseInt(document.getElementById('quantidadeJogos3').value) || 5;
            
            // Validar quantidade
            if (quantidadeJogos < 1 || quantidadeJogos > 50) {
                mostrarModal('Erro', 'Quantidade deve ser entre 1 e 50 jogos por sorteio.');
                return;
            }

            const todosNumeros = Array.from({length: 50}, (_, i) => i + 1);
            
            // Pool de n√∫meros dispon√≠veis (1-50 exceto os 12 do √∫ltimo concurso)
            const numerosDisponiveis = todosNumeros.filter(num => !numerosEliminadosGlobal.includes(num));
            
            if (numerosDisponiveis.length < 6) {
                mostrarModal('Erro', `N√∫meros dispon√≠veis insuficientes: apenas ${numerosDisponiveis.length} dispon√≠veis.`);
                return;
            }
            
            // ESTRAT√âGIA 3: Permitir repeti√ß√£o de n√∫meros entre jogos
            const jogosGerados = { primeiro: [], segundo: [] };
            
            for (let i = 0; i < quantidadeJogos; i++) {
                // Cada jogo pode usar qualquer um dos n√∫meros dispon√≠veis (permite repeti√ß√£o)
                const jogo1 = gerarJogoEquilibrado(numerosDisponiveis);
                const jogo2 = gerarJogoEquilibrado(numerosDisponiveis);
                
                jogosGerados.primeiro.push(jogo1);
                jogosGerados.segundo.push(jogo2);
            }
            
            // Adicionar ao hist√≥rico
            const horario = new Date().toLocaleTimeString('pt-BR');
            const novoPalpite = {
                id: Date.now(),
                estrategia: 3,
                jogos: jogosGerados,
                quantidade: jogosGerados.primeiro.length,
                horario: horario,
                info: `${jogosGerados.primeiro.length} jogos duplos - Eliminou concurso ${ultimoConcursoData.numero} (com repeti√ß√£o)`
            };
            
            historicoPalpitesData.unshift(novoPalpite);
            
            // Atualizar interface
            exibirResultadoEstrategia3(jogosGerados);
            atualizarHistoricoPalpites();
        }

        // Fun√ß√£o para estrat√©gia 2: Elimina√ß√£o progressiva
        function gerarEstrategia2() {
            if (!ultimoConcursoData) {
                mostrarModal('Erro', 'Nenhum dado de concurso dispon√≠vel.');
                return;
            }

            const todosNumeros = Array.from({length: 50}, (_, i) => i + 1);
            const numerosUsadosConvertidos = numerosUsadosProgressivo.map(num => parseInt(num));
            const numerosDisponiveis = todosNumeros.filter(num => !numerosUsadosConvertidos.includes(num));
            
            // Verificar se precisa reiniciar
            if (numerosDisponiveis.length < 12) { // Precisa de 12 n√∫meros (6 para cada sorteio)
                reiniciarEstrategia2();
                
                // Recalcular ap√≥s reiniciar
                const numerosUsadosReiniciados = numerosUsadosProgressivo.map(num => parseInt(num));
                const numerosDisponiveisNovo = todosNumeros.filter(num => !numerosUsadosReiniciados.includes(num));
                
                // Gerar jogos equilibrados ap√≥s reiniciar
                const palpite1 = gerarJogoEquilibrado(numerosDisponiveisNovo);
                const numerosRestantes = numerosDisponiveisNovo.filter(num => !palpite1.includes(num));
                const palpite2 = gerarJogoEquilibrado(numerosRestantes);
                
                // Atualizar arrays
                numerosUsadosProgressivo.push(...palpite1, ...palpite2);
                sequenciaAtual++;
                
                // Adicionar ao hist√≥rico
                const horario = new Date().toLocaleTimeString('pt-BR');
                const novoPalpite = {
                    id: Date.now(),
                    estrategia: 2,
                    jogos: { primeiro: [palpite1], segundo: [palpite2] },
                    horario: horario,
                    info: `Seq. ${sequenciaAtual-1} (Reiniciado)`
                };
                
                historicoPalpitesData.unshift(novoPalpite);
                
                // Atualizar interface
                exibirResultadoEstrategia2({ primeiro: [palpite1], segundo: [palpite2] }, true);
                atualizarVisualizacaoNumeros();
                atualizarStatusProgressivo();
                atualizarHistoricoPalpites();
                
                return;
            }
            
            // Gerar jogos equilibrados
            const palpite1 = gerarJogoEquilibrado(numerosDisponiveis);
            const numerosRestantes = numerosDisponiveis.filter(num => !palpite1.includes(num));
            const palpite2 = gerarJogoEquilibrado(numerosRestantes);
            
            // Atualizar arrays
            numerosUsadosProgressivo.push(...palpite1, ...palpite2);
            sequenciaAtual++;
            
            // Adicionar ao hist√≥rico
            const horario = new Date().toLocaleTimeString('pt-BR');
            const novoPalpite = {
                id: Date.now(),
                estrategia: 2,
                jogos: { primeiro: [palpite1], segundo: [palpite2] },
                horario: horario,
                info: `Sequ√™ncia ${sequenciaAtual-1}`
            };
            
            historicoPalpitesData.unshift(novoPalpite);
            
            // Atualizar interface
            exibirResultadoEstrategia2({ primeiro: [palpite1], segundo: [palpite2] }, false);
            atualizarVisualizacaoNumeros();
            atualizarStatusProgressivo();
            atualizarHistoricoPalpites();
        }

        // Fun√ß√£o para reiniciar estrat√©gia 2
        function reiniciarEstrategia2() {
            numerosUsadosProgressivo = [...numerosEliminadosGlobal];
            sequenciaAtual = 1;
        }

        // Fun√ß√£o para exibir resultado da estrat√©gia 1 (m√∫ltiplos jogos duplos)
        function exibirResultadoEstrategia1(jogos) {
            const resultadoDiv = document.getElementById('resultadoEstrategia1');
            
            let jogosHTML = '';
            for (let i = 0; i < jogos.primeiro.length; i++) {
                const numerosHTML1 = jogos.primeiro[i]
                    .map(num => `<span class="numero-palpite px-2 py-1 rounded-full text-xs font-bold font-mono">${formatarNumero(num)}</span>`)
                    .join(' ');
                
                const numerosHTML2 = jogos.segundo[i]
                    .map(num => `<span class="numero-palpite px-2 py-1 rounded-full text-xs font-bold font-mono">${formatarNumero(num)}</span>`)
                    .join(' ');
                
                jogosHTML += `
                    <div class="mb-4 p-3 bg-white dark:bg-gray-800 rounded border border-green-300 dark:border-green-600">
                        <div class="text-xs font-medium text-green-700 dark:text-green-300 mb-3 text-center">
                            Jogo ${i + 1}:
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div class="primeiro-sorteio p-2 rounded">
                                <div class="text-xs font-medium mb-2" style="color: #660d2b;">üéØ 1¬∫ Sorteio:</div>
                                <div class="flex flex-wrap gap-1 justify-center">
                                    ${numerosHTML1}
                                </div>
                            </div>
                            
                            <div class="segundo-sorteio p-2 rounded">
                                <div class="text-xs font-medium mb-2" style="color: #660d2b;">üé≤ 2¬∫ Sorteio:</div>
                                <div class="flex flex-wrap gap-1 justify-center">
                                    ${numerosHTML2}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            resultadoDiv.innerHTML = `
                <div class="bg-green-100 dark:bg-green-800 border border-green-300 dark:border-green-600 rounded-lg p-3">
                    <div class="text-sm font-medium text-green-800 dark:text-green-200 mb-3">
                        ‚úÖ ${jogos.primeiro.length} Palpite(s) Duplo(s) Gerado(s):
                    </div>
                    ${jogosHTML}
                    
                    <!-- Bot√µes de Download -->
                    <div class="mt-4 flex flex-wrap gap-2 justify-center">
                        <button onclick="baixarPalpitesDupla(${JSON.stringify(jogos).replace(/"/g, '&quot;')}, 'txt', 1)" 
                                class="bg-blue-500 hover:bg-blue-600 text-white text-xs py-1 px-3 rounded transition-colors">
                            üìÑ TXT
                        </button>
                        <button onclick="baixarPalpitesDupla(${JSON.stringify(jogos).replace(/"/g, '&quot;')}, 'html', 1)" 
                                class="bg-orange-500 hover:bg-orange-600 text-white text-xs py-1 px-3 rounded transition-colors">
                            üåê HTML
                        </button>
                        <button onclick="baixarPalpitesDupla(${JSON.stringify(jogos).replace(/"/g, '&quot;')}, 'xlsx', 1)" 
                                class="bg-green-500 hover:bg-green-600 text-white text-xs py-1 px-3 rounded transition-colors">
                            üìä XLSX
                        </button>
                    </div>
                    
                    <div class="text-xs text-green-600 dark:text-green-400 mt-2 text-center">
                        ${jogos.primeiro.length} jogo(s) duplo(s) | Eliminou ${numerosEliminadosGlobal.length} do concurso ${ultimoConcursoData.numero}
                    </div>
                </div>
            `;
            
            resultadoDiv.classList.remove('hidden');
        }

        // Fun√ß√£o para exibir resultado da estrat√©gia 3 (m√∫ltiplos jogos duplos com repeti√ß√£o)
        function exibirResultadoEstrategia3(jogos) {
            const resultadoDiv = document.getElementById('resultadoEstrategia3');
            
            let jogosHTML = '';
            for (let i = 0; i < jogos.primeiro.length; i++) {
                const numerosHTML1 = jogos.primeiro[i]
                    .map(num => `<span class="numero-palpite px-2 py-1 rounded-full text-xs font-bold font-mono">${formatarNumero(num)}</span>`)
                    .join(' ');
                
                const numerosHTML2 = jogos.segundo[i]
                    .map(num => `<span class="numero-palpite px-2 py-1 rounded-full text-xs font-bold font-mono">${formatarNumero(num)}</span>`)
                    .join(' ');
                
                jogosHTML += `
                    <div class="mb-4 p-3 bg-white dark:bg-gray-800 rounded border border-purple-300 dark:border-purple-600">
                        <div class="text-xs font-medium text-purple-700 dark:text-purple-300 mb-3 text-center">
                            Jogo ${i + 1}:
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div class="primeiro-sorteio p-2 rounded">
                                <div class="text-xs font-medium mb-2" style="color: #660d2b;">üéØ 1¬∫ Sorteio:</div>
                                <div class="flex flex-wrap gap-1 justify-center">
                                    ${numerosHTML1}
                                </div>
                            </div>
                            
                            <div class="segundo-sorteio p-2 rounded">
                                <div class="text-xs font-medium mb-2" style="color: #660d2b;">üé≤ 2¬∫ Sorteio:</div>
                                <div class="flex flex-wrap gap-1 justify-center">
                                    ${numerosHTML2}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            resultadoDiv.innerHTML = `
                <div class="bg-purple-100 dark:bg-purple-800 border border-purple-300 dark:border-purple-600 rounded-lg p-3">
                    <div class="text-sm font-medium text-purple-800 dark:text-purple-200 mb-3">
                        ‚úÖ ${jogos.primeiro.length} Palpite(s) Duplo(s) Gerado(s):
                    </div>
                    ${jogosHTML}
                    
                    <!-- Bot√µes de Download -->
                    <div class="mt-4 flex flex-wrap gap-2 justify-center">
                        <button onclick="baixarPalpitesDupla(${JSON.stringify(jogos).replace(/"/g, '&quot;')}, 'txt', 3)" 
                                class="bg-blue-500 hover:bg-blue-600 text-white text-xs py-1 px-3 rounded transition-colors">
                            üìÑ TXT
                        </button>
                        <button onclick="baixarPalpitesDupla(${JSON.stringify(jogos).replace(/"/g, '&quot;')}, 'html', 3)" 
                                class="bg-orange-500 hover:bg-orange-600 text-white text-xs py-1 px-3 rounded transition-colors">
                            üåê HTML
                        </button>
                        <button onclick="baixarPalpitesDupla(${JSON.stringify(jogos).replace(/"/g, '&quot;')}, 'xlsx', 3)" 
                                class="bg-green-500 hover:bg-green-600 text-white text-xs py-1 px-3 rounded transition-colors">
                            üìä XLSX
                        </button>
                    </div>
                    
                    <div class="text-xs text-purple-600 dark:text-purple-400 mt-2 text-center">
                        ${jogos.primeiro.length} jogo(s) duplo(s) | Eliminou ${numerosEliminadosGlobal.length} do concurso ${ultimoConcursoData.numero} | ‚ú® Permite repeti√ß√£o
                    </div>
                </div>
            `;
            
            resultadoDiv.classList.remove('hidden');
        }

        // Fun√ß√£o para exibir resultado da estrat√©gia 2
        function exibirResultadoEstrategia2(jogos, reiniciado = false) {
            const resultadoDiv = document.getElementById('resultadoEstrategia2');
            
            const numerosHTML1 = jogos.primeiro[0]
                .map(num => `<span class="numero-palpite px-2 py-1 rounded-full text-xs font-bold">${num}</span>`)
                .join(' ');
            
            const numerosHTML2 = jogos.segundo[0]
                .map(num => `<span class="numero-palpite px-2 py-1 rounded-full text-xs font-bold">${num}</span>`)
                .join(' ');
            
            const statusTexto = reiniciado ? 
                `üîÑ Reiniciado - Sequ√™ncia ${sequenciaAtual-1}` : 
                `Sequ√™ncia ${sequenciaAtual-1} de 6`;
            
            resultadoDiv.innerHTML = `
                <div class="bg-blue-100 dark:bg-blue-800 border border-blue-300 dark:border-blue-600 rounded-lg p-3">
                    <div class="text-sm font-medium text-blue-800 dark:text-blue-200 mb-3">
                        ‚úÖ Palpite Duplo Gerado:
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <div class="primeiro-sorteio p-2 rounded">
                            <div class="text-xs font-medium mb-2" style="color: #660d2b;">üéØ 1¬∫ Sorteio:</div>
                            <div class="flex flex-wrap gap-1 justify-center">
                                ${numerosHTML1}
                            </div>
                        </div>
                        
                        <div class="segundo-sorteio p-2 rounded">
                            <div class="text-xs font-medium mb-2" style="color: #660d2b;">üé≤ 2¬∫ Sorteio:</div>
                            <div class="flex flex-wrap gap-1 justify-center">
                                ${numerosHTML2}
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-xs text-blue-600 dark:text-blue-400 mt-2 text-center">
                        ${statusTexto} | 12 n√∫meros | Total eliminado: ${numerosUsadosProgressivo.length}
                    </div>
                </div>
            `;
            
            resultadoDiv.classList.remove('hidden');
        }

        // Fun√ß√£o para atualizar hist√≥rico de palpites
        function atualizarHistoricoPalpites() {
            const listaDiv = document.getElementById('listaPalpites');
            
            if (historicoPalpitesData.length === 0) {
                listaDiv.innerHTML = `
                    <p class="text-sm text-yellow-700 dark:text-yellow-300 text-center italic">
                        Nenhum palpite gerado ainda
                    </p>
                `;
                return;
            }
            
            const historicoHTML = historicoPalpitesData
                .slice(0, 10)
                .map(palpite => {
                    let estrategiaTexto;
                    switch(palpite.estrategia) {
                        case 1: estrategiaTexto = 'üé≤ Simples'; break;
                        case 2: estrategiaTexto = 'üîÑ Progressiva'; break;
                        case 3: estrategiaTexto = 'üé∞ Livre'; break;
                        default: estrategiaTexto = '‚ùì Desconhecida';
                    }
                    
                    // Para Dupla Sena, mostrar o primeiro jogo de cada sorteio
                    let numerosParaExibir = [];
                    if (palpite.jogos && palpite.jogos.primeiro && palpite.jogos.primeiro.length > 0) {
                        numerosParaExibir = [...palpite.jogos.primeiro[0], ...palpite.jogos.segundo[0]];
                    }
                    
                    const numerosHTML = numerosParaExibir
                        .map(num => `<span class="inline-block bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 px-2 py-1 rounded text-xs font-mono">${num}</span>`)
                        .join(' ');
                    
                    return `
                        <div class="bg-white dark:bg-gray-800 border border-yellow-300 dark:border-yellow-600 rounded-lg p-3">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-medium text-yellow-800 dark:text-yellow-200">
                                    ${estrategiaTexto} - ${palpite.info}
                                </span>
                                <span class="text-xs text-yellow-600 dark:text-yellow-400">
                                    ${palpite.horario}
                                </span>
                            </div>
                            <div class="flex flex-wrap gap-1">
                                ${numerosHTML}
                            </div>
                        </div>
                    `;
                })
                .join('');
            
            listaDiv.innerHTML = historicoHTML;
        }

        // Fun√ß√£o para limpar hist√≥rico
        function limparHistorico() {
            historicoPalpitesData = [];
            atualizarHistoricoPalpites();
        }

        // Event listeners do gerador de palpites
        document.getElementById('gerarEstrategia1').addEventListener('click', gerarEstrategia1);
        document.getElementById('gerarEstrategia2').addEventListener('click', gerarEstrategia2);
        document.getElementById('gerarEstrategia3').addEventListener('click', gerarEstrategia3);
        document.getElementById('resetEstrategia2').addEventListener('click', () => {
            reiniciarEstrategia2();
            atualizarVisualizacaoNumeros();
            atualizarStatusProgressivo();
            document.getElementById('resultadoEstrategia2').classList.add('hidden');
        });
        document.getElementById('limparHistorico').addEventListener('click', limparHistorico);

        // Event listeners do modal
        document.getElementById('comoFuncionaBtn').addEventListener('click', () => {
            document.getElementById('modalComoFunciona').classList.remove('hidden');
        });
        
        document.getElementById('fecharModal').addEventListener('click', () => {
            document.getElementById('modalComoFunciona').classList.add('hidden');
        });
        
        // Fechar modal clicando fora
        document.getElementById('modalComoFunciona').addEventListener('click', (e) => {
            if (e.target.id === 'modalComoFunciona') {
                document.getElementById('modalComoFunciona').classList.add('hidden');
            }
        });

        // FUN√á√ïES DE DOWNLOAD PARA DUPLA SENA

        // Fun√ß√£o para gerar conte√∫do TXT (Dupla Sena)
        function gerarTXTDupla(jogos) {
            let txt = '';
            for (let i = 0; i < jogos.primeiro.length; i++) {
                txt += `Jogo ${i + 1}:\n`;
                txt += `1¬∫ Sorteio: ${jogos.primeiro[i].map(num => formatarNumero(num)).join(' ')}\n`;
                txt += `2¬∫ Sorteio: ${jogos.segundo[i].map(num => formatarNumero(num)).join(' ')}\n\n`;
            }
            return txt;
        }

        // Fun√ß√£o para gerar conte√∫do HTML (Dupla Sena)
        function gerarHTMLDupla(jogos, estrategia) {
            const estrategiaTexto = estrategia === 1 ? 'Elimina√ß√£o Simples' : (estrategia === 2 ? 'Elimina√ß√£o Progressiva' : 'Elimina√ß√£o Livre');
            const data = new Date().toLocaleDateString('pt-BR');
            const hora = new Date().toLocaleTimeString('pt-BR');
            
            let html = `<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Palpites Dupla Sena - ${estrategiaTexto}</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; }
        .header { text-align: center; margin-bottom: 30px; }
        .jogo { margin: 15px 0; padding: 15px; border: 2px solid #ba184a; border-radius: 8px; background: #fef2f5; }
        .sorteio { margin: 10px 0; }
        .numeros { display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; }
        .numero { background: #ba184a; color: white; padding: 8px 12px; border-radius: 50%; font-weight: bold; min-width: 30px; text-align: center; }
        .info { color: #666; font-size: 14px; text-align: center; margin-top: 20px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üéØ Dupla Sena - Palpites Gerados</h1>
        <h2>Estrat√©gia: ${estrategiaTexto}</h2>
        <p>Gerado em: ${data} √†s ${hora}</p>
        <p>Eliminou concurso: ${ultimoConcursoData.numero}</p>
    </div>`;

            for (let i = 0; i < jogos.primeiro.length; i++) {
                html += `
    <div class="jogo">
        <h3>Jogo ${i + 1}</h3>
        <div class="sorteio">
            <h4>üéØ 1¬∫ Sorteio</h4>
            <div class="numeros">`;
        
        jogos.primeiro[i].forEach(num => {
            html += `<div class="numero">${formatarNumero(num)}</div>`;
        });
        
        html += `
            </div>
        </div>
        <div class="sorteio">
            <h4>üé≤ 2¬∫ Sorteio</h4>
            <div class="numeros">`;
        
        jogos.segundo[i].forEach(num => {
            html += `<div class="numero">${formatarNumero(num)}</div>`;
        });
        
        html += `
            </div>
        </div>
    </div>`;
            }

            html += `
    <div class="info">
        <p>Total de jogos: ${jogos.primeiro.length}</p>
        <p>Gerado pela aplica√ß√£o Resultados Dupla Sena</p>
    </div>
</body>
</html>`;
            
            return html;
        }

        // Fun√ß√£o para gerar conte√∫do CSV (Dupla Sena)
        function gerarCSVDupla(jogos) {
            let csv = 'Jogo,1S_Bola1,1S_Bola2,1S_Bola3,1S_Bola4,1S_Bola5,1S_Bola6,2S_Bola1,2S_Bola2,2S_Bola3,2S_Bola4,2S_Bola5,2S_Bola6\n';
            for (let i = 0; i < jogos.primeiro.length; i++) {
                const jogo1 = jogos.primeiro[i].map(num => formatarNumero(num)).join(',');
                const jogo2 = jogos.segundo[i].map(num => formatarNumero(num)).join(',');
                csv += `${i + 1},${jogo1},${jogo2}\n`;
            }
            return csv;
        }

        // Fun√ß√£o principal para baixar palpites (Dupla Sena)
        function baixarPalpitesDupla(jogos, formato, estrategia) {
            let conteudo, nomeArquivo, tipoMime;
            
            const timestamp = new Date().toISOString().slice(0,10);
            const estrategiaTexto = estrategia === 1 ? 'simples' : (estrategia === 2 ? 'progressiva' : 'livre');
            
            switch(formato) {
                case 'txt':
                    conteudo = gerarTXTDupla(jogos);
                    nomeArquivo = `palpites-dupla-sena-${estrategiaTexto}-${timestamp}.txt`;
                    tipoMime = 'text/plain';
                    break;
                
                case 'html':
                    conteudo = gerarHTMLDupla(jogos, estrategia);
                    nomeArquivo = `palpites-dupla-sena-${estrategiaTexto}-${timestamp}.html`;
                    tipoMime = 'text/html';
                    break;
                
                case 'xlsx':
                    conteudo = gerarCSVDupla(jogos);
                    nomeArquivo = `palpites-dupla-sena-${estrategiaTexto}-${timestamp}.csv`;
                    tipoMime = 'text/csv';
                    break;
                
                default:
                    mostrarModal('Erro', 'Formato n√£o suportado');
                    return;
            }
            
            // Criar e baixar arquivo
            const blob = new Blob([conteudo], { type: tipoMime });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = nomeArquivo;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        // Valida√ß√£o do input quantidade de jogos estrat√©gia 1
        document.getElementById('quantidadeJogos1').addEventListener('input', function () {
            let val = parseInt(this.value, 10);

            if (isNaN(val) || val < 1) {
                this.value = 1;
            } else if (val > 3) {
                this.value = 3;
            }
        });

        // üöÄ CARREGAR TODOS OS CONCURSOS AUTOMATICAMENTE AO ABRIR A APP
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üöÄ APP INICIADA: Carregando TODOS os concursos da Dupla Sena automaticamente...');
            await carregarTodosOsConcursos();
        });
    </script>
</body>
</html>